<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RDMnet: Using the Controller API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="etcdevtool.css" rel="stylesheet" type="text/css"/>
<link href="rdmnet_dox_styles.css" rel="stylesheet" type="text/css"/>
<!-- BEGIN CUSTOM SCRIPTS -->
<!-- BEGIN ETCDEVTOOL VERSION SELECTOR SCRIPT -->
<script type="text/javascript">
  $(function () {
    $.get('/RDMnetDocs/versions.txt', function (data) {
      if (data) {
        var lines = data.split('\n');
        if (lines.length > 0) {
          var version_select = $("#version_select").empty();
          lines.forEach(function (line) {
            line = line.trim();
            if (!line) {
              return;
            }
            line = line.split(':');
            var option_name = line[0].replace(/^v/, '');
            if (line.length > 1) {
              option_name += ' (' + line[1] + ')';
            }
            var option_val = '/RDMnetDocs/' + line[0];
            var option = $('<option></option>').attr("value", option_val)
              .text(option_name);
            if (window.location.pathname.match(line[0])) {
              option = option.attr("selected", "selected");
            }
            version_select.append(option);
          });
        }
      }
    }, 'text');
  });
</script>
<!-- END ETCDEVTOOL VERSION SELECTOR SCRIPT -->
<script type="text/javascript">
  $(function () { selectAllC() });
</script>
<script type="text/javascript">
  function selectAllC() {
    // Enable all C-language blocks
    var tabcontent = document.getElementsByClassName("code-tab-content");
    for (i = 0; i < tabcontent.length; i++) {
      if (tabcontent[i].id.endsWith("_c")) {
        tabcontent[i].style.display = "block";
      } else {
        tabcontent[i].style.display = "none"
      }
    }
    // Enable all C-language buttons
    var tablinks = document.getElementsByClassName("code-tab-links");
    for (i = 0; i < tablinks.length; i++) {
      if (tablinks[i].id.endsWith("_c")) {
        if (!tablinks[i].className.includes("active")) {
          tablinks[i].className = tablinks[i].className += " active";
        }
      } else {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
    }
  }
  function selectAllCpp() {
    // Enable all C++-language blocks
    var tabcontent = document.getElementsByClassName("code-tab-content");
    for (i = 0; i < tabcontent.length; i++) {
      if (tabcontent[i].id.endsWith("_cpp")) {
        tabcontent[i].style.display = "block";
      } else {
        tabcontent[i].style.display = "none"
      }
    }
    // Enable all C++-language buttons
    var tablinks = document.getElementsByClassName("code-tab-links");
    for (i = 0; i < tablinks.length; i++) {
      if (tablinks[i].id.endsWith("_cpp")) {
        if (!tablinks[i].className.includes("active")) {
          tablinks[i].className = tablinks[i].className += " active";
        }
      } else {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
    }
  }
  function selectLanguage(evt, block_id, language) {
    // Get all elements with class="tabcontent" and hide them
    var tabcontent = document.getElementsByClassName("code-tab-content");
    for (i = 0; i < tabcontent.length; i++) {
      if (tabcontent[i].id.startsWith("div_" + block_id)) {
        tabcontent[i].style.display = "none";
      }
    }
    // Get all elements with class="tablinks" and remove the class "active"
    var tablinks = document.getElementsByClassName("code-tab-links");
    for (i = 0; i < tablinks.length; i++) {
      if (tablinks[i].id.startsWith("button_" + block_id)) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
    }
    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById("div_" + block_id + "_" + language).style.display = "block";
    if (!evt.currentTarget.className.includes("active")) {
      evt.currentTarget.className += " active";
    }
  }
</script>
<!-- END CUSTOM SCRIPTS -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RDMnet
   &#160;<span id="projectnumber">HEAD (unstable)</span>
   </div>
   <div id="projectbrief">Implementation of ANSI E1.33 (RDMnet)</div>
  </td>
  <!-- BEGIN VERSION SELECTOR INSERTED BY ETCDEVTOOL -->
  <td style="text-align: right; padding-right: 0.5em">
    <div id="otherversions">
      View other versions:
      <select id="version_select" onchange="location = this.value">
      </select>
    </div>
  </td>
  <!-- END VERSION SELECTOR INSERTED BY ETCDEVTOOL -->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('using_controller.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using the Controller API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__tmp_tmpjj9ur1rx_docs_getting_started_using_controller"></a> The RDMnet Controller API exposes both a C and C++ language interface. The C++ interface is a header-only wrapper around the C interface.</p>
<p> 
<div class="code-tab-page-selector">
  <button id="button_1_c" class="code-tab-links" onclick="selectAllC()">Show All C Snippets</button>
  <button id="button_1_cpp" class="code-tab-links" onclick="selectAllCpp()">Show All C++ Snippets</button>
</div>
</p>
<h1>Initialization</h1>
<p>The RDMnet library must be globally initialized before using the RDMnet controller API. See <a class="el" href="global_init_and_destroy.html">Global Initialization and Destruction</a>.</p>
<p>To create a controller instance, use the <a class="el" href="group__rdmnet__controller.html#ga1860f48d433795826ce3edc8f6963c51" title="Create a new instance of RDMnet controller functionality.">rdmnet_controller_create()</a> function in C, or instantiate an <a class="el" href="classrdmnet_1_1_controller.html" title="An instance of RDMnet controller functionality.">rdmnet::Controller</a> and call its Startup() function in C++. Most apps will only need a single controller instance. One controller can monitor an arbitrary number of RDMnet scopes at once.</p>
<p>The RDMnet controller API is an asynchronous, callback-oriented API. Part of the initial configuration for a controller instance is a set of function pointers (or abstract interface) for the library to use as callbacks. Callbacks are dispatched from the background thread that is started when the RDMnet library is initialized.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_2_c" class="code-tab-links" onclick="selectLanguage(event, '2', 'c')">C</button>
  <button id="button_2_cpp" class="code-tab-links" onclick="selectLanguage(event, '2', 'cpp')">C++</button>
</div>
<div id="div_2_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="controller_8h.html">rdmnet/controller.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Sets optional values to defaults. Must pass your ESTA manufacturer ID. If you have not yet</span></div>
<div class="line"><span class="comment">// requested an ESTA manufacturer ID, the range 0x7ff0 to 0x7fff can be used for prototyping.</span></div>
<div class="line"><a class="code" href="struct_rdmnet_controller_config.html">RdmnetControllerConfig</a> config = <a class="code" href="group__rdmnet__controller.html#gab61905ff5228301100c6d70c58e77661">RDMNET_CONTROLLER_CONFIG_DEFAULT_INIT</a>(MY_ESTA_MANUFACTURER_ID_VAL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Each controller is a component that must have a Component ID (CID), which is simply a UUID.</span></div>
<div class="line"><span class="comment">// Software should generate and save a CID so that the same one is used on each run of the software.</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__uuid.html#gabb977b5a218b4b62224c016bf3932f10">etcpal_generate_os_preferred_uuid</a>(&amp;config.<a class="code" href="struct_rdmnet_controller_config.html#a4c3f7d9a58af5033f9acd8c942bf81d9">cid</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set the callback functions - defined elsewhere</span></div>
<div class="line"><span class="comment">// p_some_opaque_data is an opaque data pointer that will be passed back to each callback function</span></div>
<div class="line"><a class="code" href="group__rdmnet__controller.html#ga561941b5e39514b8015e936130c6e544">rdmnet_controller_set_callbacks</a>(&amp;config, my_controller_connected_cb, my_controller_connect_failed_cb,</div>
<div class="line">                                my_controller_disconnected_cb, my_controller_client_list_update_received_cb,</div>
<div class="line">                                my_controller_rdm_response_received_cb, my_controller_status_received_cb,</div>
<div class="line">                                p_some_opaque_data);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Needed to identify this controller to other controllers on the network. More on this later.</span></div>
<div class="line">config.<a class="code" href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">rdm_data</a>.<a class="code" href="struct_rdmnet_controller_rdm_data.html#a345b5a533872a471f810a988b331f60c">model_id</a> = 0x0001;</div>
<div class="line">config.<a class="code" href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">rdm_data</a>.<a class="code" href="struct_rdmnet_controller_rdm_data.html#a0b317a8c21931281b402432d70e5efdf">software_version_id</a> = 0x01000000;</div>
<div class="line">config.<a class="code" href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">rdm_data</a>.<a class="code" href="struct_rdmnet_controller_rdm_data.html#a644a70763eb3ec31cdaff458d7a76223">manufacturer_label</a> = <span class="stringliteral">&quot;My Manufacturer Name&quot;</span>;</div>
<div class="line">config.<a class="code" href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">rdm_data</a>.<a class="code" href="struct_rdmnet_controller_rdm_data.html#a3fd939edd5efb1239669389a426914ae">device_model_description</a> = <span class="stringliteral">&quot;My Product Name&quot;</span>;</div>
<div class="line">config.<a class="code" href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">rdm_data</a>.<a class="code" href="struct_rdmnet_controller_rdm_data.html#a0779453a5c8485f8a9fb34e2282cba60">software_version_label</a> = <span class="stringliteral">&quot;1.0.0&quot;</span>;</div>
<div class="line">config.<a class="code" href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">rdm_data</a>.<a class="code" href="struct_rdmnet_controller_rdm_data.html#abc9efd75b914c36bf2e5e768b0f31702">device_label</a> = <span class="stringliteral">&quot;My Device Label&quot;</span>;</div>
<div class="line">config.<a class="code" href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">rdm_data</a>.<a class="code" href="struct_rdmnet_controller_rdm_data.html#a5f8a4a4a490229d0d3923d0c5f809c99">device_label_settable</a> = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> my_controller_handle;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__controller.html#ga1860f48d433795826ce3edc8f6963c51">rdmnet_controller_create</a>(&amp;config, &amp;my_controller_handle);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Handle is valid and may be referenced in later calls to API functions.</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">  <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/c/fprintf.html">printf</a>(<span class="stringliteral">&quot;RDMnet controller creation failed with error: %s\n&quot;</span>, <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga4902a840d9801e02baebd4c70924c4b0">etcpal_strerror</a>(result));</div>
<div class="line">}</div>
<div class="ttc" id="acontroller_8h_html"><div class="ttname"><a href="controller_8h.html">controller.h</a></div><div class="ttdoc">Definitions for the RDMnet Controller API.</div></div>
<div class="ttc" id="afprintf_html"><div class="ttname"><a href="https://en.cppreference.com/w/cpp/io/c/fprintf.html">std::printf</a></div><div class="ttdeci">T printf(T... args)</div></div>
<div class="ttc" id="agroup__etcpal__error_html_ga4902a840d9801e02baebd4c70924c4b0"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga4902a840d9801e02baebd4c70924c4b0">etcpal_strerror</a></div><div class="ttdeci">const char * etcpal_strerror(etcpal_error_t code)</div></div>
<div class="ttc" id="agroup__etcpal__error_html_ga743b0648f0ca798ef29c9f69c6e255af"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a></div><div class="ttdeci">etcpal_error_t</div></div>
<div class="ttc" id="agroup__etcpal__error_html_gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a></div><div class="ttdeci">kEtcPalErrOk</div></div>
<div class="ttc" id="agroup__etcpal__uuid_html_gabb977b5a218b4b62224c016bf3932f10"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__uuid.html#gabb977b5a218b4b62224c016bf3932f10">etcpal_generate_os_preferred_uuid</a></div><div class="ttdeci">etcpal_error_t etcpal_generate_os_preferred_uuid(EtcPalUuid *uuid)</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga1860f48d433795826ce3edc8f6963c51"><div class="ttname"><a href="group__rdmnet__controller.html#ga1860f48d433795826ce3edc8f6963c51">rdmnet_controller_create</a></div><div class="ttdeci">etcpal_error_t rdmnet_controller_create(const RdmnetControllerConfig *config, rdmnet_controller_t *handle)</div><div class="ttdoc">Create a new instance of RDMnet controller functionality.</div><div class="ttdef"><b>Definition:</b> controller.c:255</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga561941b5e39514b8015e936130c6e544"><div class="ttname"><a href="group__rdmnet__controller.html#ga561941b5e39514b8015e936130c6e544">rdmnet_controller_set_callbacks</a></div><div class="ttdeci">void rdmnet_controller_set_callbacks(RdmnetControllerConfig *config, RdmnetControllerConnectedCallback connected, RdmnetControllerConnectFailedCallback connect_failed, RdmnetControllerDisconnectedCallback disconnected, RdmnetControllerClientListUpdateReceivedCallback client_list_update_received, RdmnetControllerRdmResponseReceivedCallback rdm_response_received, RdmnetControllerStatusReceivedCallback status_received, RdmnetControllerResponderIdsReceivedCallback responder_ids_received, void *context)</div><div class="ttdoc">Set the main callbacks in an RDMnet controller configuration structure.</div><div class="ttdef"><b>Definition:</b> controller.c:182</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_gab61905ff5228301100c6d70c58e77661"><div class="ttname"><a href="group__rdmnet__controller.html#gab61905ff5228301100c6d70c58e77661">RDMNET_CONTROLLER_CONFIG_DEFAULT_INIT</a></div><div class="ttdeci">#define RDMNET_CONTROLLER_CONFIG_DEFAULT_INIT(manu_id)</div><div class="ttdoc">A default-value initializer for an RdmnetControllerConfig struct.</div><div class="ttdef"><b>Definition:</b> controller.h:327</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_gae857478c160127b99ef4c092ac608fcb"><div class="ttname"><a href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a></div><div class="ttdeci">int rdmnet_controller_t</div><div class="ttdef"><b>Definition:</b> controller.h:54</div></div>
<div class="ttc" id="astruct_rdmnet_controller_config_html"><div class="ttname"><a href="struct_rdmnet_controller_config.html">RdmnetControllerConfig</a></div><div class="ttdoc">A set of information that defines the startup parameters of an RDMnet Controller.</div><div class="ttdef"><b>Definition:</b> controller.h:273</div></div>
<div class="ttc" id="astruct_rdmnet_controller_config_html_a4c3f7d9a58af5033f9acd8c942bf81d9"><div class="ttname"><a href="struct_rdmnet_controller_config.html#a4c3f7d9a58af5033f9acd8c942bf81d9">RdmnetControllerConfig::cid</a></div><div class="ttdeci">EtcPalUuid cid</div><div class="ttdef"><b>Definition:</b> controller.h:279</div></div>
<div class="ttc" id="astruct_rdmnet_controller_config_html_ad16d3df6d2791f5c6dd480b459ed72c5"><div class="ttname"><a href="struct_rdmnet_controller_config.html#ad16d3df6d2791f5c6dd480b459ed72c5">RdmnetControllerConfig::rdm_data</a></div><div class="ttdeci">RdmnetControllerRdmData rdm_data</div><div class="ttdef"><b>Definition:</b> controller.h:291</div></div>
<div class="ttc" id="astruct_rdmnet_controller_rdm_data_html_a0779453a5c8485f8a9fb34e2282cba60"><div class="ttname"><a href="struct_rdmnet_controller_rdm_data.html#a0779453a5c8485f8a9fb34e2282cba60">RdmnetControllerRdmData::software_version_label</a></div><div class="ttdeci">const char * software_version_label</div><div class="ttdef"><b>Definition:</b> controller.h:230</div></div>
<div class="ttc" id="astruct_rdmnet_controller_rdm_data_html_a0b317a8c21931281b402432d70e5efdf"><div class="ttname"><a href="struct_rdmnet_controller_rdm_data.html#a0b317a8c21931281b402432d70e5efdf">RdmnetControllerRdmData::software_version_id</a></div><div class="ttdeci">uint32_t software_version_id</div><div class="ttdoc">A number representing the version of the controller software.</div><div class="ttdef"><b>Definition:</b> controller.h:224</div></div>
<div class="ttc" id="astruct_rdmnet_controller_rdm_data_html_a345b5a533872a471f810a988b331f60c"><div class="ttname"><a href="struct_rdmnet_controller_rdm_data.html#a345b5a533872a471f810a988b331f60c">RdmnetControllerRdmData::model_id</a></div><div class="ttdeci">uint16_t model_id</div><div class="ttdoc">A number representing the product model which implements the controller.</div><div class="ttdef"><b>Definition:</b> controller.h:219</div></div>
<div class="ttc" id="astruct_rdmnet_controller_rdm_data_html_a3fd939edd5efb1239669389a426914ae"><div class="ttname"><a href="struct_rdmnet_controller_rdm_data.html#a3fd939edd5efb1239669389a426914ae">RdmnetControllerRdmData::device_model_description</a></div><div class="ttdeci">const char * device_model_description</div><div class="ttdef"><b>Definition:</b> controller.h:228</div></div>
<div class="ttc" id="astruct_rdmnet_controller_rdm_data_html_a5f8a4a4a490229d0d3923d0c5f809c99"><div class="ttname"><a href="struct_rdmnet_controller_rdm_data.html#a5f8a4a4a490229d0d3923d0c5f809c99">RdmnetControllerRdmData::device_label_settable</a></div><div class="ttdeci">bool device_label_settable</div><div class="ttdoc">Whether the library should allow the device_label to be changed remotely.</div><div class="ttdef"><b>Definition:</b> controller.h:249</div></div>
<div class="ttc" id="astruct_rdmnet_controller_rdm_data_html_a644a70763eb3ec31cdaff458d7a76223"><div class="ttname"><a href="struct_rdmnet_controller_rdm_data.html#a644a70763eb3ec31cdaff458d7a76223">RdmnetControllerRdmData::manufacturer_label</a></div><div class="ttdeci">const char * manufacturer_label</div><div class="ttdef"><b>Definition:</b> controller.h:226</div></div>
<div class="ttc" id="astruct_rdmnet_controller_rdm_data_html_abc9efd75b914c36bf2e5e768b0f31702"><div class="ttname"><a href="struct_rdmnet_controller_rdm_data.html#abc9efd75b914c36bf2e5e768b0f31702">RdmnetControllerRdmData::device_label</a></div><div class="ttdeci">const char * device_label</div><div class="ttdef"><b>Definition:</b> controller.h:232</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_2_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/cpp_2uuid_8h.html">etcpal/cpp/uuid.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cpp_2controller_8h.html">rdmnet/cpp/controller.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MyControllerNotifyHandler : <span class="keyword">public</span> <a class="code" href="classrdmnet_1_1_controller_1_1_notify_handler.html">rdmnet::Controller::NotifyHandler</a></div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Implement the NotifyHandler callbacks...</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">MyControllerNotifyHandler my_controller_notify_handler;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Each controller is a component that must have a Component ID (CID), which is simply a UUID.</span></div>
<div class="line"><span class="comment">// Software should generate and save a CID so that the same one is used on each run of the software.</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_uuid.html">etcpal::Uuid</a> my_cid = <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_uuid.html#ae1ccf480526751a937afb32a2db7346a">etcpal::Uuid::OsPreferred</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Contains the configuration settings that the controller needs to operate. Some of these are set</span></div>
<div class="line"><span class="comment">// to default values and can be changed if necessary. Must pass your ESTA manufacturer ID. If you</span></div>
<div class="line"><span class="comment">// have not yet requested an ESTA manufacturer ID, the range 0x7ff0 to 0x7fff can be used for</span></div>
<div class="line"><span class="comment">// prototyping.</span></div>
<div class="line"><a class="code" href="structrdmnet_1_1_controller_1_1_settings.html">rdmnet::Controller::Settings</a> my_settings(my_cid, MY_ESTA_MANUFACTURER_ID_VAL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Needed to identify this controller to other controllers on the network. More on this later.</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="structrdmnet_1_1_controller_1_1_rdm_data.html">rdmnet::Controller::RdmData</a> my_rdm_data(0x0001,                   <span class="comment">// Device Model ID</span></div>
<div class="line">                                        0x01000000,               <span class="comment">// Software Version ID</span></div>
<div class="line">                                        <span class="stringliteral">&quot;My Manufacturer Name&quot;</span>,   <span class="comment">// Manufacturer Label</span></div>
<div class="line">                                        <span class="stringliteral">&quot;My Product Name&quot;</span>,        <span class="comment">// Device Model Description</span></div>
<div class="line">                                        <span class="stringliteral">&quot;1.0.0&quot;</span>,                  <span class="comment">// Software Version Label</span></div>
<div class="line">                                        <span class="stringliteral">&quot;My Device Label&quot;</span>);       <span class="comment">// Device Label</span></div>
<div class="line"><a class="code" href="classrdmnet_1_1_controller.html">rdmnet::Controller</a> controller;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = controller.<a class="code" href="classrdmnet_1_1_controller.html#a25e1aa54e8c33ac84c6346bdd4faf36a">Startup</a>(my_controller_notify_handler, my_settings, my_rdm_data);</div>
<div class="line"><span class="keywordflow">if</span> (result)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Controller is valid and running.</span></div>
<div class="line">  <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::Controller::Handle</a> handle = controller.<a class="code" href="classrdmnet_1_1_controller.html#a6781072c11eeb54c1c235c6d5f36e1a4">handle</a>();</div>
<div class="line">  <span class="comment">// Store handle for later lookup from the NotifyHandler callback functions.</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">  <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;RDMnet controller startup failed with error: &quot;</span> &lt;&lt; result.<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_error.html#a19c380b03cea21d7ac7325136a131ff0">ToString</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">}</div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="https://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a></div></div>
<div class="ttc" id="aclassetcpal_1_1_error_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_error.html">etcpal::Error</a></div></div>
<div class="ttc" id="aclassetcpal_1_1_error_html_a19c380b03cea21d7ac7325136a131ff0"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_error.html#a19c380b03cea21d7ac7325136a131ff0">etcpal::Error::ToString</a></div><div class="ttdeci">std::string ToString() const</div></div>
<div class="ttc" id="aclassetcpal_1_1_opaque_id_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">etcpal::OpaqueId&lt; detail::ControllerHandleType, rdmnet_controller_t, RDMNET_CONTROLLER_INVALID &gt;</a></div></div>
<div class="ttc" id="aclassetcpal_1_1_uuid_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_uuid.html">etcpal::Uuid</a></div></div>
<div class="ttc" id="aclassetcpal_1_1_uuid_html_ae1ccf480526751a937afb32a2db7346a"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_uuid.html#ae1ccf480526751a937afb32a2db7346a">etcpal::Uuid::OsPreferred</a></div><div class="ttdeci">static Uuid OsPreferred() noexcept</div></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_1_1_notify_handler_html"><div class="ttname"><a href="classrdmnet_1_1_controller_1_1_notify_handler.html">rdmnet::Controller::NotifyHandler</a></div><div class="ttdoc">A base class for a class that receives notification callbacks from a controller.</div><div class="ttdef"><b>Definition:</b> controller.h:77</div></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html"><div class="ttname"><a href="classrdmnet_1_1_controller.html">rdmnet::Controller</a></div><div class="ttdoc">An instance of RDMnet controller functionality.</div><div class="ttdef"><b>Definition:</b> controller.h:67</div></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_a25e1aa54e8c33ac84c6346bdd4faf36a"><div class="ttname"><a href="classrdmnet_1_1_controller.html#a25e1aa54e8c33ac84c6346bdd4faf36a">rdmnet::Controller::Startup</a></div><div class="ttdeci">etcpal::Error Startup(NotifyHandler &amp;notify_handler, const Settings &amp;settings, const RdmData &amp;rdm_data)</div><div class="ttdoc">Allocate resources and start up this controller with the given configuration.</div><div class="ttdef"><b>Definition:</b> controller.h:521</div></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_a6781072c11eeb54c1c235c6d5f36e1a4"><div class="ttname"><a href="classrdmnet_1_1_controller.html#a6781072c11eeb54c1c235c6d5f36e1a4">rdmnet::Controller::handle</a></div><div class="ttdeci">Handle handle() const</div><div class="ttdoc">Retrieve the handle of a controller instance.</div><div class="ttdef"><b>Definition:</b> controller.h:1045</div></div>
<div class="ttc" id="acpp_2controller_8h_html"><div class="ttname"><a href="cpp_2controller_8h.html">controller.h</a></div><div class="ttdoc">C++ wrapper for the RDMnet Controller API.</div></div>
<div class="ttc" id="acpp_2uuid_8h.html_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/cpp_2uuid_8h.html">uuid.h</a></div></div>
<div class="ttc" id="astructrdmnet_1_1_controller_1_1_rdm_data_html"><div class="ttname"><a href="structrdmnet_1_1_controller_1_1_rdm_data.html">rdmnet::Controller::RdmData</a></div><div class="ttdoc">A set of initial identifying RDM data to use for a controller.</div><div class="ttdef"><b>Definition:</b> controller.h:201</div></div>
<div class="ttc" id="astructrdmnet_1_1_controller_1_1_settings_html"><div class="ttname"><a href="structrdmnet_1_1_controller_1_1_settings.html">rdmnet::Controller::Settings</a></div><div class="ttdoc">A set of configuration settings that a controller needs to initialize.</div><div class="ttdef"><b>Definition:</b> controller.h:182</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Deinitialization</h1>
<p>The controller should be shut down and destroyed gracefully before program termination. This will send a graceful disconnect message to any connected brokers and deallocate the controller's resources.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_3_c" class="code-tab-links" onclick="selectLanguage(event, '3', 'c')">C</button>
  <button id="button_3_cpp" class="code-tab-links" onclick="selectLanguage(event, '3', 'cpp')">C++</button>
</div>
<div id="div_3_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="code" href="group__rdmnet__controller.html#ga69f5287dd825ac492abe10847189d777">rdmnet_controller_destroy</a>(my_controller_handle, <a class="code" href="group__rdmnet__api__common.html#gga3eb1adaf6e830a807d1dcfbc64197222a336a46d8d36f5b1f32fac4653913cdd2">kRdmnetDisconnectShutdown</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// At this point, the controller is no longer running and its handle is no longer valid.</span></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gga3eb1adaf6e830a807d1dcfbc64197222a336a46d8d36f5b1f32fac4653913cdd2"><div class="ttname"><a href="group__rdmnet__api__common.html#gga3eb1adaf6e830a807d1dcfbc64197222a336a46d8d36f5b1f32fac4653913cdd2">kRdmnetDisconnectShutdown</a></div><div class="ttdeci">@ kRdmnetDisconnectShutdown</div><div class="ttdef"><b>Definition:</b> common.h:87</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga69f5287dd825ac492abe10847189d777"><div class="ttname"><a href="group__rdmnet__controller.html#ga69f5287dd825ac492abe10847189d777">rdmnet_controller_destroy</a></div><div class="ttdeci">etcpal_error_t rdmnet_controller_destroy(rdmnet_controller_t controller_handle, rdmnet_disconnect_reason_t reason)</div><div class="ttdoc">Destroy a controller instance.</div><div class="ttdef"><b>Definition:</b> controller.c:293</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_3_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line">controller.<a class="code" href="classrdmnet_1_1_controller.html#a911f52326aceb684a3dc4e3029785812">Shutdown</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// At this point, the controller is no longer running and its handle is no longer valid. It can be</span></div>
<div class="line"><span class="comment">// started again (with a new handle) by calling Startup() again.</span></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_a911f52326aceb684a3dc4e3029785812"><div class="ttname"><a href="classrdmnet_1_1_controller.html#a911f52326aceb684a3dc4e3029785812">rdmnet::Controller::Shutdown</a></div><div class="ttdeci">void Shutdown(rdmnet_disconnect_reason_t disconnect_reason=kRdmnetDisconnectShutdown)</div><div class="ttdoc">Shut down this controller and deallocate resources.</div><div class="ttdef"><b>Definition:</b> controller.h:636</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Managing Scopes</h1>
<p>A controller instance is initially created without any configured scopes. If the app has not been reconfigured by a user, the E1.33 RDMnet standard requires that the RDMnet default scope be configured automatically. There is a shortcut function for this. Otherwise, you can add a custom scope.</p>
<p>Per the requirements of RDMnet, a scope string is always UTF-8 and is thus represented by a char[] in C and a <a class="elRef" href="https://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> in C++.</p>
<p>See the "Scopes" section in <a class="el" href="how_it_works.html">How RDMnet Works</a> for more information on scopes.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_4_c" class="code-tab-links" onclick="selectLanguage(event, '4', 'c')">C</button>
  <button id="button_4_cpp" class="code-tab-links" onclick="selectLanguage(event, '4', 'cpp')">C++</button>
</div>
<div id="div_4_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Add a default scope</span></div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> default_scope_handle;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__controller.html#ga95f857453eb6b8da8cadaa373420ab61">rdmnet_controller_add_default_scope</a>(my_controller_handle, &amp;default_scope_handle);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Add a custom scope</span></div>
<div class="line"><a class="code" href="struct_rdmnet_scope_config.html">RdmnetScopeConfig</a> scope_config;</div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga0b906d1d6ed5fcc678e9c530e440b62f">RDMNET_CLIENT_SET_SCOPE</a>(&amp;scope_config, <span class="stringliteral">&quot;custom_scope_name&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> custom_scope_handle;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__controller.html#ga4363e0f31f3f85f5526b55d2c034ed4e">rdmnet_controller_add_scope</a>(my_controller_handle, &amp;scope_config, &amp;custom_scope_handle);</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga0b906d1d6ed5fcc678e9c530e440b62f"><div class="ttname"><a href="group__rdmnet__api__common.html#ga0b906d1d6ed5fcc678e9c530e440b62f">RDMNET_CLIENT_SET_SCOPE</a></div><div class="ttdeci">#define RDMNET_CLIENT_SET_SCOPE(configptr, scope_str)</div><div class="ttdoc">Initialize an RdmnetScopeConfig struct with a scope string.</div><div class="ttdef"><b>Definition:</b> client.h:262</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga7244ab5c8edb8bc9c1e4792a6c64f798"><div class="ttname"><a href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a></div><div class="ttdeci">int rdmnet_client_scope_t</div><div class="ttdef"><b>Definition:</b> client.h:41</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga4363e0f31f3f85f5526b55d2c034ed4e"><div class="ttname"><a href="group__rdmnet__controller.html#ga4363e0f31f3f85f5526b55d2c034ed4e">rdmnet_controller_add_scope</a></div><div class="ttdeci">etcpal_error_t rdmnet_controller_add_scope(rdmnet_controller_t controller_handle, const RdmnetScopeConfig *scope_config, rdmnet_client_scope_t *scope_handle)</div><div class="ttdoc">Add a new scope to a controller instance.</div><div class="ttdef"><b>Definition:</b> controller.c:330</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga95f857453eb6b8da8cadaa373420ab61"><div class="ttname"><a href="group__rdmnet__controller.html#ga95f857453eb6b8da8cadaa373420ab61">rdmnet_controller_add_default_scope</a></div><div class="ttdeci">etcpal_error_t rdmnet_controller_add_default_scope(rdmnet_controller_t controller_handle, rdmnet_client_scope_t *scope_handle)</div><div class="ttdoc">Add a new scope representing the default RDMnet scope to a controller instance.</div><div class="ttdef"><b>Definition:</b> controller.c:366</div></div>
<div class="ttc" id="astruct_rdmnet_scope_config_html"><div class="ttname"><a href="struct_rdmnet_scope_config.html">RdmnetScopeConfig</a></div><div class="ttdef"><b>Definition:</b> client.h:224</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_4_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html">etcpal::Expected&lt;rdmnet::ScopeHandle&gt;</a> add_res = controller.<a class="code" href="classrdmnet_1_1_controller.html#a2be4963fd7e6bc670f03415f45dc88aa">AddDefaultScope</a>();</div>
<div class="line"><span class="comment">// Or...</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html">etcpal::Expected&lt;rdmnet::ScopeHandle&gt;</a> add_res = controller.<a class="code" href="classrdmnet_1_1_controller.html#ad37920af8aba6ad63aed43982579a429">AddScope</a>(<span class="stringliteral">&quot;custom_scope_name&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (add_res)</div>
<div class="line">{</div>
<div class="line">  <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::ScopeHandle</a> default_scope_handle = *add_res;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">  <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error adding default scope: &#39;&quot;</span> &lt;&lt; add_res.<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html#a60850b440a4ff7f769627b46d79043f6">error</a>().<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_error.html#a19c380b03cea21d7ac7325136a131ff0">ToString</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassetcpal_1_1_expected_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html">etcpal::Expected</a></div></div>
<div class="ttc" id="aclassetcpal_1_1_expected_html_a60850b440a4ff7f769627b46d79043f6"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html#a60850b440a4ff7f769627b46d79043f6">etcpal::Expected::error</a></div><div class="ttdeci">constexpr Error error() const noexcept</div></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_a2be4963fd7e6bc670f03415f45dc88aa"><div class="ttname"><a href="classrdmnet_1_1_controller.html#a2be4963fd7e6bc670f03415f45dc88aa">rdmnet::Controller::AddDefaultScope</a></div><div class="ttdeci">etcpal::Expected&lt; ScopeHandle &gt; AddDefaultScope(const etcpal::SockAddr &amp;static_broker_addr=etcpal::SockAddr{})</div><div class="ttdoc">Shortcut to add the default RDMnet scope to a controller instance.</div><div class="ttdef"><b>Definition:</b> controller.h:707</div></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_ad37920af8aba6ad63aed43982579a429"><div class="ttname"><a href="classrdmnet_1_1_controller.html#ad37920af8aba6ad63aed43982579a429">rdmnet::Controller::AddScope</a></div><div class="ttdeci">etcpal::Expected&lt; ScopeHandle &gt; AddScope(const char *id, const etcpal::SockAddr &amp;static_broker_addr=etcpal::SockAddr{})</div><div class="ttdoc">Add a new scope to this controller instance.</div><div class="ttdef"><b>Definition:</b> controller.h:653</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h2>Dynamic vs Static Scopes</h2>
<p>Adding a scope will immediately begin the scope connection state machine from the RDMnet tick thread. If a static configuration is not provided (using the <a class="el" href="group__rdmnet__api__common.html#ga0b906d1d6ed5fcc678e9c530e440b62f" title="Initialize an RdmnetScopeConfig struct with a scope string.">RDMNET_CLIENT_SET_SCOPE()</a> macro to initialize an <a class="el" href="struct_rdmnet_scope_config.html">RdmnetScopeConfig</a>, or calling <a class="el" href="classrdmnet_1_1_controller.html#ad37920af8aba6ad63aed43982579a429" title="Add a new scope to this controller instance.">rdmnet::Controller::AddScope()</a> with only one argument) the first action will be to attempt to discover brokers for this scope using DNS-SD. Once a broker is found, connection will be initiated automatically, and the result will be delivered via either the connected or connect_failed callback.</p>
<p>If a broker for a given scope has been configured with a static IP address and port, you can skip DNS-SD discovery by providing a static configuration:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_5_c" class="code-tab-links" onclick="selectLanguage(event, '5', 'c')">C</button>
  <button id="button_5_cpp" class="code-tab-links" onclick="selectLanguage(event, '5', 'cpp')">C++</button>
</div>
<div id="div_5_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Get configured static broker address</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html">EtcPalSockAddr</a> static_broker_addr;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#ga92ba01cb2c81a8a97b9555ecf0ab2fe5">etcpal_string_to_ip</a>(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#gga847282e3fd17bf75ec83292326c455eea73ea615eceba61f26d92a63f3738f635">kEtcPalIpTypeV4</a>, <span class="stringliteral">&quot;192.168.2.1&quot;</span>, &amp;static_broker_addr.<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html#a19cc8016f534a565f984438cfe911a9e">ip</a>);</div>
<div class="line">static_broker_addr.<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a> = 8000;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="struct_rdmnet_scope_config.html">RdmnetScopeConfig</a> config;</div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga500c0af02a2db3a6b835f26cf304da85">RDMNET_CLIENT_SET_STATIC_SCOPE</a>(&amp;config, <span class="stringliteral">&quot;my_custom_scope&quot;</span>, static_broker_addr);</div>
<div class="line"><span class="comment">// Or:</span></div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#gab2855ff14aba079140f1070f80140247">RDMNET_CLIENT_SET_STATIC_DEFAULT_SCOPE</a>(&amp;config, static_broker_addr);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> scope_handle;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__controller.html#ga4363e0f31f3f85f5526b55d2c034ed4e">rdmnet_controller_add_scope</a>(my_controller_handle, &amp;config, &amp;scope_handle);</div>
<div class="ttc" id="agroup__etcpal__inet_html_ga92ba01cb2c81a8a97b9555ecf0ab2fe5"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#ga92ba01cb2c81a8a97b9555ecf0ab2fe5">etcpal_string_to_ip</a></div><div class="ttdeci">etcpal_error_t etcpal_string_to_ip(etcpal_iptype_t type, const char *src, EtcPalIpAddr *dest)</div></div>
<div class="ttc" id="agroup__etcpal__inet_html_gga847282e3fd17bf75ec83292326c455eea73ea615eceba61f26d92a63f3738f635"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#gga847282e3fd17bf75ec83292326c455eea73ea615eceba61f26d92a63f3738f635">kEtcPalIpTypeV4</a></div><div class="ttdeci">kEtcPalIpTypeV4</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga500c0af02a2db3a6b835f26cf304da85"><div class="ttname"><a href="group__rdmnet__api__common.html#ga500c0af02a2db3a6b835f26cf304da85">RDMNET_CLIENT_SET_STATIC_SCOPE</a></div><div class="ttdeci">#define RDMNET_CLIENT_SET_STATIC_SCOPE(configptr, scope_str, broker_addr)</div><div class="ttdoc">Initialize an RdmnetScopeConfig struct with a scope string and static broker address.</div><div class="ttdef"><b>Definition:</b> client.h:295</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gab2855ff14aba079140f1070f80140247"><div class="ttname"><a href="group__rdmnet__api__common.html#gab2855ff14aba079140f1070f80140247">RDMNET_CLIENT_SET_STATIC_DEFAULT_SCOPE</a></div><div class="ttdeci">#define RDMNET_CLIENT_SET_STATIC_DEFAULT_SCOPE(configptr, broker_addr)</div><div class="ttdoc">Initialize an RdmnetScopeConfig struct with the default RDMnet scope and a static broker address.</div><div class="ttdef"><b>Definition:</b> client.h:312</div></div>
<div class="ttc" id="astruct_etc_pal_sock_addr_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html">EtcPalSockAddr</a></div></div>
<div class="ttc" id="astruct_etc_pal_sock_addr_html_a19cc8016f534a565f984438cfe911a9e"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html#a19cc8016f534a565f984438cfe911a9e">EtcPalSockAddr::ip</a></div><div class="ttdeci">EtcPalIpAddr ip</div></div>
<div class="ttc" id="astruct_etc_pal_sock_addr_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html#a8e0798404bf2cf5dabb84c5ba9a4f236">EtcPalSockAddr::port</a></div><div class="ttdeci">uint16_t port</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_5_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Get configured static broker address</span></div>
<div class="line">etcpal::Sockaddr static_broker_addr(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_ip_addr.html#a431892e2354d1b617e2dd0278b8a9f30">etcpal::IpAddr::FromString</a>(<span class="stringliteral">&quot;192.168.2.1&quot;</span>), 8000);</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html">etcpal::Expected&lt;rdmnet::ScopeHandle&gt;</a> add_res = controller.<a class="code" href="classrdmnet_1_1_controller.html#ad37920af8aba6ad63aed43982579a429">AddScope</a>(<span class="stringliteral">&quot;my_custom_scope&quot;</span>, static_broker_addr);</div>
<div class="line"><span class="comment">// Or:</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html">etcpal::Expected&lt;rdmnet::ScopeHandle&gt;</a> add_res = controller.<a class="code" href="classrdmnet_1_1_controller.html#a2be4963fd7e6bc670f03415f45dc88aa">AddDefaultScope</a>(static_broker_addr);</div>
<div class="ttc" id="aclassetcpal_1_1_ip_addr_html_a431892e2354d1b617e2dd0278b8a9f30"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_ip_addr.html#a431892e2354d1b617e2dd0278b8a9f30">etcpal::IpAddr::FromString</a></div><div class="ttdeci">static IpAddr FromString(const char *ip_str) noexcept</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Handling Callbacks</h1>
<p>The library will dispatch callback notifications from the background thread which is started when <a class="el" href="group__rdmnet__api__common.html#gac35e678c3cc099a73e9314614215e1d8" title="Initialize the RDMnet library.">rdmnet_init()</a> is called. It is safe to call any RDMnet API function from any callback; in fact, this is the recommended way of handling many callbacks.</p>
<p>For example, a very common controller behavior will be to fetch a client list from the broker after a successful connection:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_6_c" class="code-tab-links" onclick="selectLanguage(event, '6', 'c')">C</button>
  <button id="button_6_cpp" class="code-tab-links" onclick="selectLanguage(event, '6', 'cpp')">C++</button>
</div>
<div id="div_6_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> controller_connected_callback(<a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> controller_handle, <a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> scope_handle,</div>
<div class="line">                                   <span class="keyword">const</span> <a class="code" href="struct_rdmnet_client_connected_info.html">RdmnetClientConnectedInfo</a>* info, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> addr_str[<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#gacd7ec0d81e171166483c7629669bf05d">ETCPAL_IP_STRING_BYTES</a>];</div>
<div class="line">  <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#gaf98da0ae21f7960b5e046c55b8d79c4a">etcpal_ip_to_string</a>(&amp;info-&gt;<a class="code" href="struct_rdmnet_client_connected_info.html#a1c91e6a2d74ad074f828527c7f3b4ecd">broker_addr</a>.<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html#a19cc8016f534a565f984438cfe911a9e">ip</a>, addr_str);</div>
<div class="line">  <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/c/fprintf.html">printf</a>(<span class="stringliteral">&quot;Connected to broker &#39;%s&#39; at address %s:%d\n&quot;</span>, info-&gt;<a class="code" href="struct_rdmnet_client_connected_info.html#acfd73dc5ff0567920ec01970fb41aaba">broker_name</a>, addr_str, info-&gt;<a class="code" href="struct_rdmnet_client_connected_info.html#a1c91e6a2d74ad074f828527c7f3b4ecd">broker_addr</a>.<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/struct_etc_pal_sock_addr.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Check handles and/or context as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__rdmnet__controller.html#ga6d30907e6d09ada38a1be228d0f6809c">rdmnet_controller_request_client_list</a>(controller_handle, scope_handle);</div>
<div class="line">}                                   </div>
<div class="ttc" id="agroup__etcpal__inet_html_gacd7ec0d81e171166483c7629669bf05d"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#gacd7ec0d81e171166483c7629669bf05d">ETCPAL_IP_STRING_BYTES</a></div><div class="ttdeci">#define ETCPAL_IP_STRING_BYTES</div></div>
<div class="ttc" id="agroup__etcpal__inet_html_gaf98da0ae21f7960b5e046c55b8d79c4a"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__inet.html#gaf98da0ae21f7960b5e046c55b8d79c4a">etcpal_ip_to_string</a></div><div class="ttdeci">etcpal_error_t etcpal_ip_to_string(const EtcPalIpAddr *src, char *dest)</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga6d30907e6d09ada38a1be228d0f6809c"><div class="ttname"><a href="group__rdmnet__controller.html#ga6d30907e6d09ada38a1be228d0f6809c">rdmnet_controller_request_client_list</a></div><div class="ttdeci">etcpal_error_t rdmnet_controller_request_client_list(rdmnet_controller_t controller_handle, rdmnet_client_scope_t scope_handle)</div><div class="ttdoc">Request a client list from a broker.</div><div class="ttdef"><b>Definition:</b> controller.c:542</div></div>
<div class="ttc" id="astruct_rdmnet_client_connected_info_html"><div class="ttname"><a href="struct_rdmnet_client_connected_info.html">RdmnetClientConnectedInfo</a></div><div class="ttdef"><b>Definition:</b> client.h:151</div></div>
<div class="ttc" id="astruct_rdmnet_client_connected_info_html_a1c91e6a2d74ad074f828527c7f3b4ecd"><div class="ttname"><a href="struct_rdmnet_client_connected_info.html#a1c91e6a2d74ad074f828527c7f3b4ecd">RdmnetClientConnectedInfo::broker_addr</a></div><div class="ttdeci">EtcPalSockAddr broker_addr</div><div class="ttdef"><b>Definition:</b> client.h:153</div></div>
<div class="ttc" id="astruct_rdmnet_client_connected_info_html_acfd73dc5ff0567920ec01970fb41aaba"><div class="ttname"><a href="struct_rdmnet_client_connected_info.html#acfd73dc5ff0567920ec01970fb41aaba">RdmnetClientConnectedInfo::broker_name</a></div><div class="ttdeci">const char * broker_name</div><div class="ttdef"><b>Definition:</b> client.h:155</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_6_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyControllerNotifyHandler::HandleConnectedToBroker(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::Controller::Handle</a> controller_handle,</div>
<div class="line">                                                        <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::ScopeHandle</a> scope_handle,</div>
<div class="line">                                                        <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_client_connected_info.html">rdmnet::ClientConnectedInfo</a>&amp; info)</div>
<div class="line">{</div>
<div class="line">  <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Connected to broker &#39;&quot;</span> &lt;&lt; info.<a class="code" href="classrdmnet_1_1_client_connected_info.html#a3a8402ac03dfec3f25f97fe97d518700">broker_name</a>()</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;&#39; at IP address &quot;</span> &lt;&lt; info.<a class="code" href="classrdmnet_1_1_client_connected_info.html#aece06f4235f21c75c4ff690b5885e004">broker_addr</a>().<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_sock_addr.html#a19c380b03cea21d7ac7325136a131ff0">ToString</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Check handles as necessary and get controller instance...</span></div>
<div class="line">  controller.<a class="code" href="classrdmnet_1_1_controller.html#a8adfcc838c7de3215b396dc9de0ef668">RequestClientList</a>(scope_handle);</div>
<div class="line">}</div>
<div class="ttc" id="aclassetcpal_1_1_sock_addr_html_a19c380b03cea21d7ac7325136a131ff0"><div class="ttname"><a href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_sock_addr.html#a19c380b03cea21d7ac7325136a131ff0">etcpal::SockAddr::ToString</a></div><div class="ttdeci">std::string ToString() const</div></div>
<div class="ttc" id="aclassrdmnet_1_1_client_connected_info_html"><div class="ttname"><a href="classrdmnet_1_1_client_connected_info.html">rdmnet::ClientConnectedInfo</a></div><div class="ttdoc">Information about a successful connection to a broker delivered to an RDMnet callback function.</div><div class="ttdef"><b>Definition:</b> client.h:158</div></div>
<div class="ttc" id="aclassrdmnet_1_1_client_connected_info_html_a3a8402ac03dfec3f25f97fe97d518700"><div class="ttname"><a href="classrdmnet_1_1_client_connected_info.html#a3a8402ac03dfec3f25f97fe97d518700">rdmnet::ClientConnectedInfo::broker_name</a></div><div class="ttdeci">std::string broker_name() const</div><div class="ttdoc">Get the DNS name of the broker (if it was discovered via DNS-SD; otherwise this will be an empty stri...</div><div class="ttdef"><b>Definition:</b> client.h:193</div></div>
<div class="ttc" id="aclassrdmnet_1_1_client_connected_info_html_aece06f4235f21c75c4ff690b5885e004"><div class="ttname"><a href="classrdmnet_1_1_client_connected_info.html#aece06f4235f21c75c4ff690b5885e004">rdmnet::ClientConnectedInfo::broker_addr</a></div><div class="ttdeci">constexpr etcpal::SockAddr broker_addr() const noexcept</div><div class="ttdoc">Get the IP address and port of the remote broker to which we have connected.</div><div class="ttdef"><b>Definition:</b> client.h:187</div></div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_a8adfcc838c7de3215b396dc9de0ef668"><div class="ttname"><a href="classrdmnet_1_1_controller.html#a8adfcc838c7de3215b396dc9de0ef668">rdmnet::Controller::RequestClientList</a></div><div class="ttdeci">etcpal::Error RequestClientList(ScopeHandle scope_handle)</div><div class="ttdoc">Request a client list from a broker.</div><div class="ttdef"><b>Definition:</b> controller.h:882</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h2>Connection Failure</h2>
<p>It's worth noting connection failure as a special case here. RDMnet connections can fail for many reasons, including user misconfiguration, network misconfiguration, components starting up or shutting down, programming errors, and more.</p>
<p>The ClientConnectFailedInfo and ClientDisconnectedInfo structs passed back with the "connect failed" and "disconnected" callbacks respectively have comprehensive information about the failure, including enum values containing the library's categorization of the failure, protocol reason codes and socket errors where applicable. This information is typically used mostly for logging and debugging. Each of these codes has a respective <code>to_string()</code> function to aid in logging.</p>
<p>For programmatic use, the structs also contain a <code>will_retry</code> member which indicates whether the library plans to retry this connection in the background. The only circumstances under which the library will not retry is when a connection failure is determined to be either a programming error or a user misconfiguration. Some examples of these circumstances are:</p>
<ul>
<li>The broker explicitly rejected a connection with a reason code indicating a configuration error, such as <code>CONNECT_SCOPE_MISMATCH</code> or <code>CONNECT_DUPLICATE_UID</code>.</li>
<li>The library failed to create a network socket before the connection was initiated.</li>
</ul>
<h1>Discovering Devices</h1>
<p>To discover devices in RDMnet, you need to request a <em>Client List</em> from the broker you're connected to. In our API, this is very easy - as we saw in the callbacks section earlier, we can just call <a class="el" href="group__rdmnet__controller.html#ga6d30907e6d09ada38a1be228d0f6809c" title="Request a client list from a broker.">rdmnet_controller_request_client_list()</a> or <a class="el" href="classrdmnet_1_1_controller.html#a8adfcc838c7de3215b396dc9de0ef668" title="Request a client list from a broker.">rdmnet::Controller::RequestClientList()</a>. This sends the appropriate request to the broker, and the reply will come back in the "Client List Update" callback:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_7_c" class="code-tab-links" onclick="selectLanguage(event, '7', 'c')">C</button>
  <button id="button_7_cpp" class="code-tab-links" onclick="selectLanguage(event, '7', 'cpp')">C++</button>
</div>
<div id="div_7_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> my_client_list_update_cb(<a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> controller_handle, <a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> scope_handle,</div>
<div class="line">                              <a class="code" href="group__rdmnet__api__common.html#ga47e9b8ab4e35d074085d3d9a91f77ac2">client_list_action_t</a> list_action, <span class="keyword">const</span> <a class="code" href="struct_rdmnet_rpt_client_list.html">RdmnetRptClientList</a>* list, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles and/or context as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (list_action)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a28f365664cab7adfffbad8c478ca3a09">kRdmnetClientListAppend</a>:</div>
<div class="line">      <span class="comment">// These are new entries to be added to the list of clients. Append the new entry to our</span></div>
<div class="line">      <span class="comment">// bookkeeping.</span></div>
<div class="line">      add_new_clients(list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#a66f28e829e9ff1f5c0ec95a7338e8b85">client_entries</a>, list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#afccd922a3754fa31008826b55b692c66">num_client_entries</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a62a9556be67db06e0fd26dbd5a20ff45">kRdmnetClientListRemove</a>:</div>
<div class="line">      <span class="comment">// These are entries to be removed from the list of clients. Remove the entry from our</span></div>
<div class="line">      <span class="comment">// bookkeeping.</span></div>
<div class="line">      remove_clients(list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#a66f28e829e9ff1f5c0ec95a7338e8b85">client_entries</a>, list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#afccd922a3754fa31008826b55b692c66">num_client_entries</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a8401f8f58863ec76c40f9f1fd84d3440">kRdmnetClientListUpdate</a>:</div>
<div class="line">      <span class="comment">// These are entries to be updated in the list of clients. Update the corresponding entry</span></div>
<div class="line">      <span class="comment">// in our bookkeeping.</span></div>
<div class="line">      update_clients(list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#a66f28e829e9ff1f5c0ec95a7338e8b85">client_entries</a>, list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#afccd922a3754fa31008826b55b692c66">num_client_entries</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a93835bbdfa444ea89287ecb5416b1704">kRdmnetClientListReplace</a>:</div>
<div class="line">      <span class="comment">// This is the full client list currently connected to the broker - our existing client </span></div>
<div class="line">      <span class="comment">// list should be replaced wholesale with this one. This will be the response to</span></div>
<div class="line">      <span class="comment">// rdmnet_controller_request_client_list(); the other cases are sent unsolicited.</span></div>
<div class="line">      replace_client_list(list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#a66f28e829e9ff1f5c0ec95a7338e8b85">client_entries</a>, list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#afccd922a3754fa31008826b55b692c66">num_client_entries</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (list-&gt;<a class="code" href="struct_rdmnet_rpt_client_list.html#ab5dd6470d680d9c5f2237907d37ef69b">more_coming</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// The library ran out of memory pool space while allocating client entries - after this</span></div>
<div class="line">    <span class="comment">// callback returns, another will be delivered with the continuation of this response.</span></div>
<div class="line">    <span class="comment">// If RDMNET_DYNAMIC_MEM == 1 (the default on non-embedded platforms), this flag will never be</span></div>
<div class="line">    <span class="comment">// set to true and does not need to be checked.</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga47e9b8ab4e35d074085d3d9a91f77ac2"><div class="ttname"><a href="group__rdmnet__api__common.html#ga47e9b8ab4e35d074085d3d9a91f77ac2">client_list_action_t</a></div><div class="ttdeci">client_list_action_t</div><div class="ttdef"><b>Definition:</b> client.h:50</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gga47e9b8ab4e35d074085d3d9a91f77ac2a28f365664cab7adfffbad8c478ca3a09"><div class="ttname"><a href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a28f365664cab7adfffbad8c478ca3a09">kRdmnetClientListAppend</a></div><div class="ttdeci">@ kRdmnetClientListAppend</div><div class="ttdef"><b>Definition:</b> client.h:52</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gga47e9b8ab4e35d074085d3d9a91f77ac2a62a9556be67db06e0fd26dbd5a20ff45"><div class="ttname"><a href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a62a9556be67db06e0fd26dbd5a20ff45">kRdmnetClientListRemove</a></div><div class="ttdeci">@ kRdmnetClientListRemove</div><div class="ttdef"><b>Definition:</b> client.h:54</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gga47e9b8ab4e35d074085d3d9a91f77ac2a8401f8f58863ec76c40f9f1fd84d3440"><div class="ttname"><a href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a8401f8f58863ec76c40f9f1fd84d3440">kRdmnetClientListUpdate</a></div><div class="ttdeci">@ kRdmnetClientListUpdate</div><div class="ttdef"><b>Definition:</b> client.h:56</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gga47e9b8ab4e35d074085d3d9a91f77ac2a93835bbdfa444ea89287ecb5416b1704"><div class="ttname"><a href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a93835bbdfa444ea89287ecb5416b1704">kRdmnetClientListReplace</a></div><div class="ttdeci">@ kRdmnetClientListReplace</div><div class="ttdef"><b>Definition:</b> client.h:58</div></div>
<div class="ttc" id="astruct_rdmnet_rpt_client_list_html"><div class="ttname"><a href="struct_rdmnet_rpt_client_list.html">RdmnetRptClientList</a></div><div class="ttdef"><b>Definition:</b> message.h:399</div></div>
<div class="ttc" id="astruct_rdmnet_rpt_client_list_html_a66f28e829e9ff1f5c0ec95a7338e8b85"><div class="ttname"><a href="struct_rdmnet_rpt_client_list.html#a66f28e829e9ff1f5c0ec95a7338e8b85">RdmnetRptClientList::client_entries</a></div><div class="ttdeci">RdmnetRptClientEntry * client_entries</div><div class="ttdef"><b>Definition:</b> message.h:401</div></div>
<div class="ttc" id="astruct_rdmnet_rpt_client_list_html_ab5dd6470d680d9c5f2237907d37ef69b"><div class="ttname"><a href="struct_rdmnet_rpt_client_list.html#ab5dd6470d680d9c5f2237907d37ef69b">RdmnetRptClientList::more_coming</a></div><div class="ttdeci">bool more_coming</div><div class="ttdef"><b>Definition:</b> message.h:410</div></div>
<div class="ttc" id="astruct_rdmnet_rpt_client_list_html_afccd922a3754fa31008826b55b692c66"><div class="ttname"><a href="struct_rdmnet_rpt_client_list.html#afccd922a3754fa31008826b55b692c66">RdmnetRptClientList::num_client_entries</a></div><div class="ttdeci">size_t num_client_entries</div><div class="ttdef"><b>Definition:</b> message.h:403</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_7_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyControllerNotifyHandler::HandleClientListUpdate(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::Controller::Handle</a> controller_handle,</div>
<div class="line">                                                       <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::ScopeHandle</a> scope_handle,</div>
<div class="line">                                                       <a class="code" href="group__rdmnet__api__common.html#ga47e9b8ab4e35d074085d3d9a91f77ac2">client_list_action_t</a> list_action,</div>
<div class="line">                                                       <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_rpt_client_list.html">rdmnet::RptClientList</a>&amp; list)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (list_action)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a28f365664cab7adfffbad8c478ca3a09">kRdmnetClientListAppend</a>:</div>
<div class="line">      <span class="comment">// These are new entries to be added to the list of clients. Append the new entry to our</span></div>
<div class="line">      <span class="comment">// bookkeeping.</span></div>
<div class="line">      AddNewClients(list.<a class="code" href="classrdmnet_1_1_rpt_client_list.html#aaf81641004fcb987a9dee6f2cf39cf1c">GetClientEntries</a>());</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a62a9556be67db06e0fd26dbd5a20ff45">kRdmnetClientListRemove</a>:</div>
<div class="line">      <span class="comment">// These are entries to be removed from the list of clients. Remove the entry from our</span></div>
<div class="line">      <span class="comment">// bookkeeping.</span></div>
<div class="line">      RemoveClients(list.<a class="code" href="classrdmnet_1_1_rpt_client_list.html#aaf81641004fcb987a9dee6f2cf39cf1c">GetClientEntries</a>());</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a8401f8f58863ec76c40f9f1fd84d3440">kRdmnetClientListUpdate</a>:</div>
<div class="line">      <span class="comment">// These are entries to be updated in the list of clients. Update the corresponding entry</span></div>
<div class="line">      <span class="comment">// in our bookkeeping.</span></div>
<div class="line">      UpdateClients(list.<a class="code" href="classrdmnet_1_1_rpt_client_list.html#aaf81641004fcb987a9dee6f2cf39cf1c">GetClientEntries</a>());</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="group__rdmnet__api__common.html#gga47e9b8ab4e35d074085d3d9a91f77ac2a93835bbdfa444ea89287ecb5416b1704">kRdmnetClientListReplace</a>:</div>
<div class="line">      <span class="comment">// This is the full client list currently connected to the broker - our existing client </span></div>
<div class="line">      <span class="comment">// list should be replaced wholesale with this one. This will be the response to</span></div>
<div class="line">      <span class="comment">// Controller::RequestClientList(); the other cases are sent unsolicited.</span></div>
<div class="line">      ReplaceClientList(list.<a class="code" href="classrdmnet_1_1_rpt_client_list.html#aaf81641004fcb987a9dee6f2cf39cf1c">GetClientEntries</a>());</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (list.<a class="code" href="classrdmnet_1_1_rpt_client_list.html#a4dc9106ad47f1f076eb8195dbba22d24">more_coming</a>())</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// The library ran out of memory pool space while allocating client entries - after this</span></div>
<div class="line">    <span class="comment">// callback returns, another will be delivered with the continuation of this response.</span></div>
<div class="line">    <span class="comment">// If RDMNET_DYNAMIC_MEM == 1 (the default on non-embedded platforms), this flag will never be</span></div>
<div class="line">    <span class="comment">// set to true and does not need to be checked.</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_rpt_client_list_html"><div class="ttname"><a href="classrdmnet_1_1_rpt_client_list.html">rdmnet::RptClientList</a></div><div class="ttdoc">A list of RPT client entries.</div><div class="ttdef"><b>Definition:</b> rpt_client.h:89</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rpt_client_list_html_a4dc9106ad47f1f076eb8195dbba22d24"><div class="ttname"><a href="classrdmnet_1_1_rpt_client_list.html#a4dc9106ad47f1f076eb8195dbba22d24">rdmnet::RptClientList::more_coming</a></div><div class="ttdeci">constexpr bool more_coming() const noexcept</div><div class="ttdoc">This message contains a partial list.</div><div class="ttdef"><b>Definition:</b> rpt_client.h:134</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rpt_client_list_html_aaf81641004fcb987a9dee6f2cf39cf1c"><div class="ttname"><a href="classrdmnet_1_1_rpt_client_list.html#aaf81641004fcb987a9dee6f2cf39cf1c">rdmnet::RptClientList::GetClientEntries</a></div><div class="ttdeci">std::vector&lt; RptClientEntry &gt; GetClientEntries() const</div><div class="ttdoc">Copy out the list of client entries.</div><div class="ttdef"><b>Definition:</b> rpt_client.h:119</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>Brokers also send Client List Update messages asynchronously when things change; these messages contain only the differences from the last client list sent to a given controller. This means you should only have to request a full client list when a new connection completes; after that, expect periodic callbacks notifying you of changes, with the <a class="el" href="group__rdmnet__api__common.html#ga47e9b8ab4e35d074085d3d9a91f77ac2">client_list_action_t</a> set appropriately as shown above.</p>
<p>Clients include both devices and other controllers; to differentiate the two, check the type field in each RPT client entry structure.</p>
<h1>Sending RDM Commands</h1>
<p>Sending RDM commands requires a destination address structure to indicate the RDMnet component and RDM responder to which the command is addressed. See <a class="el" href="devices_and_gateways.html">Devices and Gateways</a> for more information on the fields of the destination address structure.</p>
<p>The caller retains ownership of any data buffers supplied to the RDM command sending API functions. See <a class="el" href="data_ownership.html">Data Ownership Paradigms in the RDMnet Library</a> for more information.</p>
<p>After sending a command, the library will provide a <em>sequence number</em> that will be echoed in the corresponding RDM response. This sequence number should be saved.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_8_c" class="code-tab-links" onclick="selectLanguage(event, '8', 'c')">C</button>
  <button id="button_8_cpp" class="code-tab-links" onclick="selectLanguage(event, '8', 'cpp')">C++</button>
</div>
<div id="div_8_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="code" href="struct_rdmnet_destination_addr.html">RdmnetDestinationAddr</a> dest = <a class="code" href="group__rdmnet__api__common.html#ga58f3b5c690b7ebd792e8d2851af95ea0">RDMNET_ADDR_TO_DEFAULT_RESPONDER</a>(0x6574, 0x12345678);</div>
<div class="line">uint32_t cmd_seq_num;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__controller.html#ga872fb3896fb620b339635bd40830e03f">rdmnet_controller_send_get_command</a>(my_controller_handle, my_scope_handle, &amp;dest,</div>
<div class="line">                                                           E120_DEVICE_LABEL, NULL, 0, &amp;cmd_seq_num);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// cmd_seq_num identifies this command transaction. Store it for when a response is received.</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga58f3b5c690b7ebd792e8d2851af95ea0"><div class="ttname"><a href="group__rdmnet__api__common.html#ga58f3b5c690b7ebd792e8d2851af95ea0">RDMNET_ADDR_TO_DEFAULT_RESPONDER</a></div><div class="ttdeci">#define RDMNET_ADDR_TO_DEFAULT_RESPONDER(manu_id, dev_id)</div><div class="ttdoc">Initialize an RdmnetDestinationAddr with a default responder address.</div><div class="ttdef"><b>Definition:</b> client.h:106</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga872fb3896fb620b339635bd40830e03f"><div class="ttname"><a href="group__rdmnet__controller.html#ga872fb3896fb620b339635bd40830e03f">rdmnet_controller_send_get_command</a></div><div class="ttdeci">etcpal_error_t rdmnet_controller_send_get_command(rdmnet_controller_t controller_handle, rdmnet_client_scope_t scope_handle, const RdmnetDestinationAddr *destination, uint16_t param_id, const uint8_t *data, uint8_t data_len, uint32_t *seq_num)</div><div class="ttdoc">Send an RDM GET command from a controller on a scope.</div><div class="ttdef"><b>Definition:</b> controller.c:666</div></div>
<div class="ttc" id="astruct_rdmnet_destination_addr_html"><div class="ttname"><a href="struct_rdmnet_destination_addr.html">RdmnetDestinationAddr</a></div><div class="ttdoc">A destination address for an RDM command in RDMnet's RPT protocol.</div><div class="ttdef"><b>Definition:</b> client.h:84</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_8_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> dest_addr = <a class="code" href="classrdmnet_1_1_destination_addr.html#a7bc53b1eb1a6563b1d1b8f2cfbd6d29f">rdmnet::DestinationAddr::ToDefaultResponder</a>(0x6574, 0x12345678);</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_expected.html">etcpal::Expected&lt;uint32_t&gt;</a> result = controller.<a class="code" href="classrdmnet_1_1_controller.html#a40b043dd06f47a40fc991f95f73229ae">SendGetCommand</a>(my_scope_handle, dest_addr, E120_DEVICE_LABEL);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (result)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// *result identifies this command transaction. Store it for when a response is received.</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_a40b043dd06f47a40fc991f95f73229ae"><div class="ttname"><a href="classrdmnet_1_1_controller.html#a40b043dd06f47a40fc991f95f73229ae">rdmnet::Controller::SendGetCommand</a></div><div class="ttdeci">etcpal::Expected&lt; uint32_t &gt; SendGetCommand(ScopeHandle scope_handle, const DestinationAddr &amp;destination, uint16_t param_id, const uint8_t *data=nullptr, uint8_t data_len=0)</div><div class="ttdoc">Send an RDM GET command from a controller on a scope.</div><div class="ttdef"><b>Definition:</b> controller.h:833</div></div>
<div class="ttc" id="aclassrdmnet_1_1_destination_addr_html_a7bc53b1eb1a6563b1d1b8f2cfbd6d29f"><div class="ttname"><a href="classrdmnet_1_1_destination_addr.html#a7bc53b1eb1a6563b1d1b8f2cfbd6d29f">rdmnet::DestinationAddr::ToDefaultResponder</a></div><div class="ttdeci">static constexpr DestinationAddr ToDefaultResponder(const rdm::Uid &amp;rdmnet_uid, uint16_t subdevice=0)</div><div class="ttdoc">Get a DestinationAddr representing a message addressed to a component's default responder.</div><div class="ttdef"><b>Definition:</b> client.h:103</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Handling RDM Responses</h1>
<p>Responses to commands you send will be delivered asynchronously through the "RDM response" callback. You may also receive "unsolicited responses" - asynchronous state updates from devices that don't correspond to changes you requested.</p>
<p>Responses are always delivered atomically in RDMnet (contrast this with RDM, which uses the ACK_OVERFLOW mechanism to deliver responses with oversized data). This means that RDM response data in RDMnet can be larger than the 231-byte limit that is customary in RDM. The only time a response can be fragmented is if the RDMnet library was compiled with dynamic memory allocation disabled (see the note on the more_coming flag below for more information on this).</p>
<p>Note that response callbacks reference data buffers owned by the library, which will be invalid when the callback returns. See <a class="el" href="data_ownership.html">Data Ownership Paradigms in the RDMnet Library</a> for more information.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_9_c" class="code-tab-links" onclick="selectLanguage(event, '9', 'c')">C</button>
  <button id="button_9_cpp" class="code-tab-links" onclick="selectLanguage(event, '9', 'cpp')">C++</button>
</div>
<div id="div_9_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> rdm_response_callback(<a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> controller_handle, <a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> scope_handle,</div>
<div class="line">                           <span class="keyword">const</span> <a class="code" href="struct_rdmnet_rdm_response.html">RdmnetRdmResponse</a>* resp, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles and/or context as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (resp-&gt;<a class="code" href="struct_rdmnet_rdm_response.html#acccd24ff374a39ca8a8b78c631803d60">is_response_to_me</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Verify resp-&gt;seq_num against the cmd_seq_num you stored earlier. This command transaction is</span></div>
<div class="line">    <span class="comment">// now finished.</span></div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// This is either an unsolicited RDM response (an asynchronous update about a change you didn&#39;t initiate)</span></div>
<div class="line">    <span class="comment">// or a response to a command by another controller. Use it to update your cached data about this</span></div>
<div class="line">    <span class="comment">// RDMnet responder.</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// If RDMNET_RESP_ORIGINAL_COMMAND_INCLUDED(resp) == true, resp-&gt;cmd will contain the original command you sent. </span></div>
<div class="line"> </div>
<div class="line">  handle_response_data(resp-&gt;<a class="code" href="struct_rdmnet_rdm_response.html#a8617009d72714a9a5b6a509d520bc81f">rdm_header</a>.param_id, resp-&gt;<a class="code" href="struct_rdmnet_rdm_response.html#a2f507182f83446298f3772477adabddb">rdm_data</a>, resp-&gt;<a class="code" href="struct_rdmnet_rdm_response.html#a5f39c37f64aba9cf21336ba98a66c18f">rdm_data_len</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// RdmnetRdmResponse structures do not own their data and the data will be invalid when this callback</span></div>
<div class="line">  <span class="comment">// returns. To save the data for later processing:</span></div>
<div class="line">  <a class="code" href="struct_rdmnet_saved_rdm_response.html">RdmnetSavedRdmResponse</a> saved_resp;</div>
<div class="line">  <a class="code" href="group__rdmnet__api__common.html#gad5d372571287234f8d82988755a1e967">rdmnet_save_rdm_response</a>(resp, &amp;saved_resp);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (resp-&gt;<a class="code" href="struct_rdmnet_rdm_response.html#ab5dd6470d680d9c5f2237907d37ef69b">more_coming</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// The library ran out of memory pool space while allocating responses - after this callback</span></div>
<div class="line">    <span class="comment">// returns, another will be delivered with the continuation of this response data.</span></div>
<div class="line">    <span class="comment">// If RDMNET_DYNAMIC_MEM == 1 (the default on non-embedded platforms), this flag will never be</span></div>
<div class="line">    <span class="comment">// set to true.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// When more responses come, you can append their data to your saved response:</span></div>
<div class="line">    <a class="code" href="group__rdmnet__api__common.html#ga480d58441aecb63a71b68b2fce5ba8b5">rdmnet_append_to_saved_rdm_response</a>(resp, &amp;previously_saved_resp);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Ready to process the next response, so return true.</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga480d58441aecb63a71b68b2fce5ba8b5"><div class="ttname"><a href="group__rdmnet__api__common.html#ga480d58441aecb63a71b68b2fce5ba8b5">rdmnet_append_to_saved_rdm_response</a></div><div class="ttdeci">etcpal_error_t rdmnet_append_to_saved_rdm_response(const RdmnetRdmResponse *new_response, RdmnetSavedRdmResponse *previously_saved_response)</div><div class="ttdoc">Append more data to a SavedRdmResponse's parameter data.</div><div class="ttdef"><b>Definition:</b> message.c:152</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gad5d372571287234f8d82988755a1e967"><div class="ttname"><a href="group__rdmnet__api__common.html#gad5d372571287234f8d82988755a1e967">rdmnet_save_rdm_response</a></div><div class="ttdeci">etcpal_error_t rdmnet_save_rdm_response(const RdmnetRdmResponse *response, RdmnetSavedRdmResponse *saved_response)</div><div class="ttdoc">Save the data in a received RDM response for later use from a different context.</div><div class="ttdef"><b>Definition:</b> message.c:102</div></div>
<div class="ttc" id="astruct_rdmnet_rdm_response_html"><div class="ttname"><a href="struct_rdmnet_rdm_response.html">RdmnetRdmResponse</a></div><div class="ttdef"><b>Definition:</b> message.h:91</div></div>
<div class="ttc" id="astruct_rdmnet_rdm_response_html_a2f507182f83446298f3772477adabddb"><div class="ttname"><a href="struct_rdmnet_rdm_response.html#a2f507182f83446298f3772477adabddb">RdmnetRdmResponse::rdm_data</a></div><div class="ttdeci">const uint8_t * rdm_data</div><div class="ttdef"><b>Definition:</b> message.h:117</div></div>
<div class="ttc" id="astruct_rdmnet_rdm_response_html_a5f39c37f64aba9cf21336ba98a66c18f"><div class="ttname"><a href="struct_rdmnet_rdm_response.html#a5f39c37f64aba9cf21336ba98a66c18f">RdmnetRdmResponse::rdm_data_len</a></div><div class="ttdeci">size_t rdm_data_len</div><div class="ttdef"><b>Definition:</b> message.h:119</div></div>
<div class="ttc" id="astruct_rdmnet_rdm_response_html_a8617009d72714a9a5b6a509d520bc81f"><div class="ttname"><a href="struct_rdmnet_rdm_response.html#a8617009d72714a9a5b6a509d520bc81f">RdmnetRdmResponse::rdm_header</a></div><div class="ttdeci">RdmResponseHeader rdm_header</div><div class="ttdef"><b>Definition:</b> message.h:115</div></div>
<div class="ttc" id="astruct_rdmnet_rdm_response_html_ab5dd6470d680d9c5f2237907d37ef69b"><div class="ttname"><a href="struct_rdmnet_rdm_response.html#ab5dd6470d680d9c5f2237907d37ef69b">RdmnetRdmResponse::more_coming</a></div><div class="ttdeci">bool more_coming</div><div class="ttdef"><b>Definition:</b> message.h:128</div></div>
<div class="ttc" id="astruct_rdmnet_rdm_response_html_acccd24ff374a39ca8a8b78c631803d60"><div class="ttname"><a href="struct_rdmnet_rdm_response.html#acccd24ff374a39ca8a8b78c631803d60">RdmnetRdmResponse::is_response_to_me</a></div><div class="ttdeci">bool is_response_to_me</div><div class="ttdoc">Whether the response was sent in response to a command previously sent by this controller.</div><div class="ttdef"><b>Definition:</b> message.h:102</div></div>
<div class="ttc" id="astruct_rdmnet_saved_rdm_response_html"><div class="ttname"><a href="struct_rdmnet_saved_rdm_response.html">RdmnetSavedRdmResponse</a></div><div class="ttdoc">An RDM response received over RDMnet and saved for later processing.</div><div class="ttdef"><b>Definition:</b> message.h:139</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_9_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MyControllerNotifyHandler::HandleRdmResponse(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::Controller::Handle</a> controller_handle,</div>
<div class="line">                                                  <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::ScopeHandle</a> scope_handle,</div>
<div class="line">                                                  <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_rdm_response.html">rdmnet::RdmResponse</a>&amp; resp)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (resp.is_response_to_me())</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Verify resp.seq_num() against the command seq_num you stored earlier. This command transaction is</span></div>
<div class="line">    <span class="comment">// now finished.</span></div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// This is either an unsolicited RDM response (an asynchronous update about a change you didn&#39;t initiate)</span></div>
<div class="line">    <span class="comment">// or a response to a command by another controller. Use it to update your cached data about this</span></div>
<div class="line">    <span class="comment">// RDMnet responder.</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// If resp.OriginalCommandIncluded() == true, the original_cmd_...() getters will contain the data</span></div>
<div class="line">  <span class="comment">// of the original command that instigated this response.</span></div>
<div class="line"> </div>
<div class="line">  HandleResponseData(resp.<a class="code" href="classrdmnet_1_1_rdm_response.html#aeb06b87b7d84f9dcb290a7ac38a9f326">param_id</a>(), resp.<a class="code" href="classrdmnet_1_1_rdm_response.html#a3f4c46c5e6a3a561bad84c6a91ecc8f0">data</a>(), resp.<a class="code" href="classrdmnet_1_1_rdm_response.html#a8d204c73ea8d56026afee5ffc33837d4">data_len</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// RdmResponse classes do not own their data and the data will be invalid when this callback returns.</span></div>
<div class="line">  <span class="comment">// To save the data for later processing:</span></div>
<div class="line">  <a class="code" href="classrdmnet_1_1_saved_rdm_response.html">rdmnet::SavedRdmResponse</a> saved_resp = resp.<a class="code" href="classrdmnet_1_1_rdm_response.html#a0335b1755b8460984334d4f02317c999">Save</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (resp.<a class="code" href="classrdmnet_1_1_rdm_response.html#a4dc9106ad47f1f076eb8195dbba22d24">more_coming</a>())</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// The library ran out of memory pool space while allocating responses - after this callback</span></div>
<div class="line">    <span class="comment">// returns, another will be delivered with the continuation of this response.</span></div>
<div class="line">    <span class="comment">// If RDMNET_DYNAMIC_MEM == 1 (the default on non-embedded platforms), this flag will never be set to true.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// When more responses come, you can append their data to your saved response:</span></div>
<div class="line">    previously_saved_resp.<a class="code" href="classrdmnet_1_1_saved_rdm_response.html#aa1f1176d89981ff7018955a238d9c05c">AppendData</a>(resp);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Ready to process the next response, so return true.</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_rdm_response_html"><div class="ttname"><a href="classrdmnet_1_1_rdm_response.html">rdmnet::RdmResponse</a></div><div class="ttdoc">An RDM response received over RDMnet and delivered to an RDMnet callback function.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:47</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rdm_response_html_a0335b1755b8460984334d4f02317c999"><div class="ttname"><a href="classrdmnet_1_1_rdm_response.html#a0335b1755b8460984334d4f02317c999">rdmnet::RdmResponse::Save</a></div><div class="ttdeci">SavedRdmResponse Save() const</div><div class="ttdoc">Save the data in this response for later use from a different context.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:411</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rdm_response_html_a3f4c46c5e6a3a561bad84c6a91ecc8f0"><div class="ttname"><a href="classrdmnet_1_1_rdm_response.html#a3f4c46c5e6a3a561bad84c6a91ecc8f0">rdmnet::RdmResponse::data</a></div><div class="ttdeci">constexpr const uint8_t * data() const noexcept</div><div class="ttdoc">Get a pointer to the RDM parameter data buffer contained within this response.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:279</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rdm_response_html_a4dc9106ad47f1f076eb8195dbba22d24"><div class="ttname"><a href="classrdmnet_1_1_rdm_response.html#a4dc9106ad47f1f076eb8195dbba22d24">rdmnet::RdmResponse::more_coming</a></div><div class="ttdeci">constexpr bool more_coming() const noexcept</div><div class="ttdoc">This message contains partial RDM data.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:296</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rdm_response_html_a8d204c73ea8d56026afee5ffc33837d4"><div class="ttname"><a href="classrdmnet_1_1_rdm_response.html#a8d204c73ea8d56026afee5ffc33837d4">rdmnet::RdmResponse::data_len</a></div><div class="ttdeci">constexpr size_t data_len() const noexcept</div><div class="ttdoc">Get the length of the RDM parameter data contained within this response.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:285</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rdm_response_html_aeb06b87b7d84f9dcb290a7ac38a9f326"><div class="ttname"><a href="classrdmnet_1_1_rdm_response.html#aeb06b87b7d84f9dcb290a7ac38a9f326">rdmnet::RdmResponse::param_id</a></div><div class="ttdeci">constexpr uint16_t param_id() const noexcept</div><div class="ttdoc">Get the RDM parameter ID (PID) of this response.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:267</div></div>
<div class="ttc" id="aclassrdmnet_1_1_saved_rdm_response_html"><div class="ttname"><a href="classrdmnet_1_1_saved_rdm_response.html">rdmnet::SavedRdmResponse</a></div><div class="ttdoc">An RDM response received over RDMnet and saved for later processing.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:111</div></div>
<div class="ttc" id="aclassrdmnet_1_1_saved_rdm_response_html_aa1f1176d89981ff7018955a238d9c05c"><div class="ttname"><a href="classrdmnet_1_1_saved_rdm_response.html#aa1f1176d89981ff7018955a238d9c05c">rdmnet::SavedRdmResponse::AppendData</a></div><div class="ttdeci">void AppendData(const RdmResponse &amp;new_resp)</div><div class="ttdoc">Append more data to this response's parameter data.</div><div class="ttdef"><b>Definition:</b> rdm_response.h:672</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h2>Delaying Processing of RDM Responses</h2>
<p>In the case where your application doesn't have the resources to process an RDM response, you can return false to trigger another notification for the same response at a later time:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_10_c" class="code-tab-links" onclick="selectLanguage(event, '10', 'c')">C</button>
  <button id="button_10_cpp" class="code-tab-links" onclick="selectLanguage(event, '10', 'cpp')">C++</button>
</div>
<div id="div_10_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> rdm_response_callback(<a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> controller_handle, <a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> scope_handle,</div>
<div class="line">                           <span class="keyword">const</span> <a class="code" href="struct_rdmnet_rdm_response.html">RdmnetRdmResponse</a>* resp, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles and/or context as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span>(my_app.rdm_response_queue_has_room)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Save response and add it to the queue...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Ready for the next response, so return true.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Can&#39;t queue this response yet, so return false. This function will be called again later with the same response.</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p> 
</div>
<div id="div_10_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MyControllerNotifyHandler::HandleRdmResponse(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::Controller::Handle</a> controller_handle,</div>
<div class="line">                                                  <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::ScopeHandle</a> scope_handle,</div>
<div class="line">                                                  <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_rdm_response.html">rdmnet::RdmResponse</a>&amp; resp)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span>(my_app_.RdmResponseQueueHasRoom())</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Save response and add it to the queue...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Ready for the next response, so return true.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Can&#39;t queue this response yet, so return false. This function will be called again later with the same response.</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p> 
</div>
</p>
<p>The application can do this consecutively for as long as needed, but keep in mind that this will delay the library's processing of future messages from the broker (ultimately delaying potential notifications), and may also narrow the TCP window of the connection with the broker, potentially resulting in backpressure.</p>
<h1>Handling RPT Status Messages</h1>
<p>If something went wrong while either a broker or device was processing your message, you will get a response called an "RPT Status". There is a separate callback for handling these messages.</p>
<p>When you send an RDM command, you start a transaction that is identified by a 32-bit sequence number. That transaction is considered completed when you get either an RDM Response or an RPT Status containing that same sequence number.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_11_c" class="code-tab-links" onclick="selectLanguage(event, '11', 'c')">C</button>
  <button id="button_11_cpp" class="code-tab-links" onclick="selectLanguage(event, '11', 'cpp')">C++</button>
</div>
<div id="div_11_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> rpt_status_callback(<a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> controller_handle, <a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> scope_handle,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="struct_rdmnet_rpt_status.html">RdmnetRptStatus</a>* status, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles and/or context as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Verify status-&gt;seq_num against the cmd_seq_num you stored earlier.</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">char</span> uid_str[RDM_UID_STRING_BYTES];</div>
<div class="line">  rdm_uid_to_string(&amp;status-&gt;<a class="code" href="struct_rdmnet_rpt_status.html#a40cba7d6d1910fb740982421cf66c5d6">source_uid</a>, uid_str);</div>
<div class="line">  <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/c/fprintf.html">printf</a>(<span class="stringliteral">&quot;Error sending RDM command to device %s: &#39;%s&#39;\n&quot;</span>, uid_str,</div>
<div class="line">         <a class="code" href="group__rdmnet__api__common.html#ga1b678629569257697ec6a7e855c71623">rdmnet_rpt_status_code_to_string</a>(status-&gt;<a class="code" href="struct_rdmnet_rpt_status.html#ad1e92880377c93c4e7a412a5bb57639c">status_code</a>));</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Other logic as needed; remove our internal storage of the RDM transaction, etc.</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga1b678629569257697ec6a7e855c71623"><div class="ttname"><a href="group__rdmnet__api__common.html#ga1b678629569257697ec6a7e855c71623">rdmnet_rpt_status_code_to_string</a></div><div class="ttdeci">const char * rdmnet_rpt_status_code_to_string(rpt_status_code_t code)</div><div class="ttdoc">Get a string representation of an RPT status code.</div><div class="ttdef"><b>Definition:</b> common.c:305</div></div>
<div class="ttc" id="astruct_rdmnet_rpt_status_html"><div class="ttname"><a href="struct_rdmnet_rpt_status.html">RdmnetRptStatus</a></div><div class="ttdef"><b>Definition:</b> message.h:194</div></div>
<div class="ttc" id="astruct_rdmnet_rpt_status_html_a40cba7d6d1910fb740982421cf66c5d6"><div class="ttname"><a href="struct_rdmnet_rpt_status.html#a40cba7d6d1910fb740982421cf66c5d6">RdmnetRptStatus::source_uid</a></div><div class="ttdeci">RdmUid source_uid</div><div class="ttdef"><b>Definition:</b> message.h:196</div></div>
<div class="ttc" id="astruct_rdmnet_rpt_status_html_ad1e92880377c93c4e7a412a5bb57639c"><div class="ttname"><a href="struct_rdmnet_rpt_status.html#ad1e92880377c93c4e7a412a5bb57639c">RdmnetRptStatus::status_code</a></div><div class="ttdeci">rpt_status_code_t status_code</div><div class="ttdef"><b>Definition:</b> message.h:202</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_11_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyControllerNotifyHandler::HandleRptStatus(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::Controller::Handle</a> controller_handle,</div>
<div class="line">                                                <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::ScopeHandle</a> scope_handle,</div>
<div class="line">                                                <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_rpt_status.html">rdmnet::RptStatus</a>&amp; status)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Verify status.seq_num() against the result of rdmnet::Controller::SendRdmCommand() you stored earlier.</span></div>
<div class="line"> </div>
<div class="line">  <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error sending RDM command to device &quot;</span> &lt;&lt; status.<a class="code" href="classrdmnet_1_1_rpt_status.html#a1c0c6f98dd20230051f07f9d43a5f824">source_uid</a>().ToString() &lt;&lt; <span class="stringliteral">&quot;: &#39;&quot;</span></div>
<div class="line">            &lt;&lt; status.<a class="code" href="classrdmnet_1_1_rpt_status.html#a6d5108147af76197fe672d5355221e0a">CodeToString</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Other logic as needed; remove our internal storage of the RDM transaction, etc.</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_rpt_status_html"><div class="ttname"><a href="classrdmnet_1_1_rpt_status.html">rdmnet::RptStatus</a></div><div class="ttdoc">An RPT status message received over RDMnet and delivered to an RDMnet callback function.</div><div class="ttdef"><b>Definition:</b> rpt_status.h:42</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rpt_status_html_a1c0c6f98dd20230051f07f9d43a5f824"><div class="ttname"><a href="classrdmnet_1_1_rpt_status.html#a1c0c6f98dd20230051f07f9d43a5f824">rdmnet::RptStatus::source_uid</a></div><div class="ttdeci">constexpr rdm::Uid source_uid() const noexcept</div><div class="ttdoc">Get the UID of the RDMnet component that sent this RPT status message.</div><div class="ttdef"><b>Definition:</b> rpt_status.h:110</div></div>
<div class="ttc" id="aclassrdmnet_1_1_rpt_status_html_a6d5108147af76197fe672d5355221e0a"><div class="ttname"><a href="classrdmnet_1_1_rpt_status.html#a6d5108147af76197fe672d5355221e0a">rdmnet::RptStatus::CodeToString</a></div><div class="ttdeci">std::string CodeToString() const</div><div class="ttdoc">Convert the status message's code to a string representation.</div><div class="ttdef"><b>Definition:</b> rpt_status.h:152</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Getting Responder IDs</h1>
<p>Controllers may encounter RDMnet responders which have dynamic UIDs. Base RDMnet components such as controllers and devices can have dynamic UIDs, as can virtual responders present on devices. See <a class="el" href="devices_and_gateways.html">Devices and Gateways</a> for more information on virtual responders, and <a class="el" href="roles_and_addressing.html">Roles and Addressing</a> for more information on dynamic UIDs. As a reminder, a dynamic UID is identified by the top bit of the Manufacturer ID portion being set and the UID not being a broadcast UID; this can be tested using the convenience methods in the RDM library: RDMNET_UID_IS_DYNAMIC() and/or rdm::Uid::IsDynamic().</p>
<p>A responder using a dynamic UID may get a different UID at any time. For this reason, it is useful for a controller to be able to get a more permanent identifier for an RDMnet responder.</p>
<p>For controllers, devices and brokers, the permanent identifier is the CID, which is present alongside the UID in an RPT client list entry. If you want to track these components beyond a single RDMnet session, be sure to store the CID.</p>
<p>Virtual responders present on a device have a similar identifier called a Responder ID (RID) which has the same function as a CID for that virtual responder. The UIDs of a device's virtual responders are obtained using the <code>ENDPOINT_RESPONDERS</code> RDM command; however, this command's data does not include the RID. To obtain RIDs for a set of virtual responders, it is necessary to query the connected broker.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_12_c" class="code-tab-links" onclick="selectLanguage(event, '12', 'c')">C</button>
  <button id="button_12_cpp" class="code-tab-links" onclick="selectLanguage(event, '12', 'cpp')">C++</button>
</div>
<div id="div_12_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> handle_response_data(uint16_t param_id, <span class="keyword">const</span> uint8_t* param_data, <span class="keywordtype">size_t</span> param_data_len)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// This code is simplified and meant to illustrate an example of discovering virtual responders</span></div>
<div class="line">  <span class="comment">// using the ENDPOINT_RESPONDERS command.</span></div>
<div class="line">  <span class="keywordflow">if</span> (param_id == E137_7_ENDPOINT_RESPONDERS)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordtype">size_t</span> num_uids = ((param_data_len - 6) / 6); <span class="comment">// 6 bytes per UID, subtract the other data field sizes</span></div>
<div class="line">    RdmUid* responder_uids = (RdmUid*)<a class="codeRef" href="https://en.cppreference.com/w/cpp/memory/c/calloc.html">calloc</a>(num_uids, <span class="keyword">sizeof</span>(RdmUid));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Unpack the response data into the responder_uids array...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now request the RIDs from the broker for the responder UIDs.</span></div>
<div class="line">    <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__controller.html#ga94cd30fd8391da362ba2331d24ffadae">rdmnet_controller_request_responder_ids</a>(my_controller_handle, my_scope_handle,</div>
<div class="line">                                                                    responder_uids, num_uids);</div>
<div class="line">    <span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// The broker&#39;s response will be forwarded to the RdmnetControllerResponderIdsReceivedCallback,</span></div>
<div class="line">      <span class="comment">// defined in the next snippet.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="codeRef" href="https://en.cppreference.com/w/cpp/memory/c/free.html">free</a>(responder_uids);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="acalloc_html"><div class="ttname"><a href="https://en.cppreference.com/w/cpp/memory/c/calloc.html">std::calloc</a></div><div class="ttdeci">T calloc(T... args)</div></div>
<div class="ttc" id="afree_html"><div class="ttname"><a href="https://en.cppreference.com/w/cpp/memory/c/free.html">std::free</a></div><div class="ttdeci">T free(T... args)</div></div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga94cd30fd8391da362ba2331d24ffadae"><div class="ttname"><a href="group__rdmnet__controller.html#ga94cd30fd8391da362ba2331d24ffadae">rdmnet_controller_request_responder_ids</a></div><div class="ttdeci">etcpal_error_t rdmnet_controller_request_responder_ids(rdmnet_controller_t controller_handle, rdmnet_client_scope_t scope_handle, const RdmUid *uids, size_t num_uids)</div><div class="ttdoc">Request a set of responder IDs corresponding with dynamic responder UIDs from a broker.</div><div class="ttdef"><b>Definition:</b> controller.c:574</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_12_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyControllerNotifyHandler::HandleResponseData(uint16_t param_id, <span class="keyword">const</span> uint8_t* param_data, <span class="keywordtype">size_t</span> param_data_len)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// This code is simplified and meant to illustrate an example of discovering virtual responders</span></div>
<div class="line">  <span class="comment">// using the ENDPOINT_RESPONDERS command.</span></div>
<div class="line">  <span class="keywordflow">if</span> (param_id == E137_7_ENDPOINT_RESPONDERS)</div>
<div class="line">  {</div>
<div class="line">    <a class="codeRef" href="https://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;RdmUid&gt;</a> responder_uids;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Unpack the response data into the responder_uids array...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now request the RIDs from the broker for the responder UIDs.</span></div>
<div class="line">    <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = controller.<a class="code" href="classrdmnet_1_1_controller.html#a3cd650d20751f2943214e70e65e96693">RequestResponderIds</a>(responder_uids);</div>
<div class="line">    <span class="keywordflow">if</span> (result)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// The broker&#39;s response will be forwarded to the MyControllerNotifyHandler::HandleResponderIdsReceived()</span></div>
<div class="line">      <span class="comment">// callback, defined in the next snippet.</span></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_controller_html_a3cd650d20751f2943214e70e65e96693"><div class="ttname"><a href="classrdmnet_1_1_controller.html#a3cd650d20751f2943214e70e65e96693">rdmnet::Controller::RequestResponderIds</a></div><div class="ttdeci">etcpal::Error RequestResponderIds(ScopeHandle scope_handle, const rdm::Uid *uids, size_t num_uids)</div><div class="ttdoc">Request mappings from dynamic UIDs to Responder IDs (RIDs).</div><div class="ttdef"><b>Definition:</b> controller.h:897</div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="https://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt; RdmUid &gt;</a></div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>The broker will respond with a list of mappings between dynamic UIDs and RIDs known as a Dynamic UID Assignment List. Each entry in the list will contain a status code indicating whether the RID was looked up successfully, followed by the UID and RID.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_13_c" class="code-tab-links" onclick="selectLanguage(event, '13', 'c')">C</button>
  <button id="button_13_cpp" class="code-tab-links" onclick="selectLanguage(event, '13', 'cpp')">C++</button>
</div>
<div id="div_13_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> handle_responder_ids_received(<a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> controller_handle, <a class="code" href="group__rdmnet__api__common.html#ga7244ab5c8edb8bc9c1e4792a6c64f798">rdmnet_client_scope_t</a> scope_handle,</div>
<div class="line">                                   <span class="keyword">const</span> <a class="code" href="struct_rdmnet_dynamic_uid_assignment_list.html">RdmnetDynamicUidAssignmentList</a>* list, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles and/or context as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="struct_rdmnet_dynamic_uid_mapping.html">RdmnetDynamicUidMapping</a>* mapping = list-&gt;<a class="code" href="struct_rdmnet_dynamic_uid_assignment_list.html#a629bce35ca88bc540a9cf08d025e57f0">mappings</a>; mapping &lt; list-&gt;mappings + list-&gt;<a class="code" href="struct_rdmnet_dynamic_uid_assignment_list.html#ab8ad4a3f70ee274d6b08420f50d706a2">num_mappings</a>;</div>
<div class="line">       ++mapping)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (mapping-&gt;status_code == <a class="code" href="group__rdmnet__api__common.html#ggafc5c9ee7dffbca259051716bacea9620a1b3e6c28f0859c283862abf73923b388">kRdmnetDynamicUidStatusOk</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// This function is assumed to add the RID to the responder&#39;s cached data.</span></div>
<div class="line">      add_responder_rid(&amp;mapping-&gt;uid, &amp;mapping-&gt;rid);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">char</span> uid_str[RDM_UID_STRING_BYTES];</div>
<div class="line">      rdm_uid_to_string(&amp;mapping-&gt;uid, uid_str);</div>
<div class="line">      <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/c/fprintf.html">printf</a>(<span class="stringliteral">&quot;Error obtaining RID for responder %s: &#39;%s&#39;\n&quot;</span>, uid_str,</div>
<div class="line">             <a class="code" href="group__rdmnet__api__common.html#ga362e057a96421081d8551d65bf403b6a">rdmnet_dynamic_uid_status_to_string</a>(mapping-&gt;status_code));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga362e057a96421081d8551d65bf403b6a"><div class="ttname"><a href="group__rdmnet__api__common.html#ga362e057a96421081d8551d65bf403b6a">rdmnet_dynamic_uid_status_to_string</a></div><div class="ttdeci">const char * rdmnet_dynamic_uid_status_to_string(rdmnet_dynamic_uid_status_t code)</div><div class="ttdoc">Get a string description of an RDMnet Dynamic UID status code.</div><div class="ttdef"><b>Definition:</b> common.c:466</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ggafc5c9ee7dffbca259051716bacea9620a1b3e6c28f0859c283862abf73923b388"><div class="ttname"><a href="group__rdmnet__api__common.html#ggafc5c9ee7dffbca259051716bacea9620a1b3e6c28f0859c283862abf73923b388">kRdmnetDynamicUidStatusOk</a></div><div class="ttdeci">@ kRdmnetDynamicUidStatusOk</div><div class="ttdef"><b>Definition:</b> common.h:136</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_assignment_list_html"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_assignment_list.html">RdmnetDynamicUidAssignmentList</a></div><div class="ttdef"><b>Definition:</b> message.h:246</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_assignment_list_html_a629bce35ca88bc540a9cf08d025e57f0"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_assignment_list.html#a629bce35ca88bc540a9cf08d025e57f0">RdmnetDynamicUidAssignmentList::mappings</a></div><div class="ttdeci">RdmnetDynamicUidMapping * mappings</div><div class="ttdef"><b>Definition:</b> message.h:248</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_assignment_list_html_ab8ad4a3f70ee274d6b08420f50d706a2"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_assignment_list.html#ab8ad4a3f70ee274d6b08420f50d706a2">RdmnetDynamicUidAssignmentList::num_mappings</a></div><div class="ttdeci">size_t num_mappings</div><div class="ttdef"><b>Definition:</b> message.h:250</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_mapping_html"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_mapping.html">RdmnetDynamicUidMapping</a></div><div class="ttdef"><b>Definition:</b> message.h:235</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_13_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyControllerNotifyHandler::HandleResponderIdsReceived(<a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::Controller::Handle</a> controller_handle,</div>
<div class="line">                                                           <a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_opaque_id.html">rdmnet::ScopeHandle</a> scope_handle,</div>
<div class="line">                                                           <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_dynamic_uid_assignment_list.html">rdmnet::DynamicUidAssignmentList</a>&amp; list)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="structrdmnet_1_1_dynamic_uid_mapping.html">rdmnet::DynamicUidMapping</a>&amp; mapping : list.<a class="code" href="classrdmnet_1_1_dynamic_uid_assignment_list.html#a7624de9f796db1f4487a2aa79507f99a">GetMappings</a>())</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (mapping.IsOk())</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// This function is assumed to add the RID to the responder&#39;s cached data.</span></div>
<div class="line">      AddResponderRid(mapping.uid, mapping.rid);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">      <a class="codeRef" href="https://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; <span class="stringliteral">&quot;Error obtaining RID for responder &quot;</span> &lt;&lt; mapping.uid.ToString() &lt;&lt; <span class="stringliteral">&quot;: &#39;&quot;</span></div>
<div class="line">                &lt;&lt; mapping.CodeToString() &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_dynamic_uid_assignment_list_html"><div class="ttname"><a href="classrdmnet_1_1_dynamic_uid_assignment_list.html">rdmnet::DynamicUidAssignmentList</a></div><div class="ttdoc">A list of mappings from dynamic UIDs to responder IDs received from an RDMnet broker.</div><div class="ttdef"><b>Definition:</b> dynamic_uid.h:99</div></div>
<div class="ttc" id="aclassrdmnet_1_1_dynamic_uid_assignment_list_html_a7624de9f796db1f4487a2aa79507f99a"><div class="ttname"><a href="classrdmnet_1_1_dynamic_uid_assignment_list.html#a7624de9f796db1f4487a2aa79507f99a">rdmnet::DynamicUidAssignmentList::GetMappings</a></div><div class="ttdeci">std::vector&lt; DynamicUidMapping &gt; GetMappings() const</div><div class="ttdoc">Copy out the list of dynamic UID mappings.</div><div class="ttdef"><b>Definition:</b> dynamic_uid.h:130</div></div>
<div class="ttc" id="astructrdmnet_1_1_dynamic_uid_mapping_html"><div class="ttname"><a href="structrdmnet_1_1_dynamic_uid_mapping.html">rdmnet::DynamicUidMapping</a></div><div class="ttdoc">A mapping from a dynamic UID to a responder ID (RID).</div><div class="ttdef"><b>Definition:</b> dynamic_uid.h:42</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Handling RDM Commands</h1>
<p>In addition to getting information about responders, RDMnet controllers are required to respond to a basic set of RDM commands, which allows them to be identified by other controllers on the network. By default, this behavior is implemented completely within the library.</p>
<p>The default implementation provides read-only access to the standard set of data that is required to be readable from a controller. This includes the current scope(s) (<code>COMPONENT_SCOPE</code>), search domain (<code>SEARCH_DOMAIN</code>), and RDMnet communication diagnostic data (<code>TCP_COMMS_STATUS</code>), as well as some basic RDM data like the manufacturer (<code>MANUFACTURER_LABEL</code>), a description of the product (<code>DEVICE_MODEL_DESCRIPTION</code>), the software version in string form (<code>SOFTWARE_VERSION_LABEL</code>) and a user-settable label for the controller (<code>DEVICE_LABEL</code>). The library has access to all the information necessary for the first three items, since that information is necessary for RDMnet communication. Initial values for the last four items are provided to the library when creating a new controller instance, through the rdmnet_controller_set_rdm_data() function or the <a class="el" href="structrdmnet_1_1_controller_1_1_rdm_data.html" title="A set of initial identifying RDM data to use for a controller.">rdmnet::Controller::RdmData</a> structure.</p>
<p>If you want to provide richer RDM responder functionality from your controller implementation, you can provide a set of callbacks to handle RDM commands. In this case, the library only handle <code>TCP_COMMS_STATUS</code>, and you must handle the rest of the above PIDs, as well as <code>SUPPORTED_PARAMETERS</code> and any additional ones you choose to support.</p>
<p>To use the library this way, you can:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_14_c" class="code-tab-links" onclick="selectLanguage(event, '14', 'c')">C</button>
  <button id="button_14_cpp" class="code-tab-links" onclick="selectLanguage(event, '14', 'cpp')">C++</button>
</div>
<div id="div_14_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="code" href="struct_rdmnet_controller_config.html">RdmnetControllerConfig</a> config = <a class="code" href="group__rdmnet__controller.html#gab61905ff5228301100c6d70c58e77661">RDMNET_CONTROLLER_CONFIG_DEFAULT_INIT</a>(MY_ESTA_MANUFACTURER_ID_VAL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate CID and call rdmnet_controller_set_callbacks() as above...</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__rdmnet__controller.html#ga93c798fdaf4d9fc3f97fab91605db300">rdmnet_controller_set_rdm_cmd_callbacks</a>(&amp;config, my_rdm_command_received_cb, my_llrp_rdm_command_received_cb);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__rdmnet__controller.html#gae857478c160127b99ef4c092ac608fcb">rdmnet_controller_t</a> my_controller_handle;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__controller.html#ga1860f48d433795826ce3edc8f6963c51">rdmnet_controller_create</a>(&amp;config, &amp;my_controller_handle);</div>
<div class="ttc" id="agroup__rdmnet__controller_html_ga93c798fdaf4d9fc3f97fab91605db300"><div class="ttname"><a href="group__rdmnet__controller.html#ga93c798fdaf4d9fc3f97fab91605db300">rdmnet_controller_set_rdm_cmd_callbacks</a></div><div class="ttdeci">void rdmnet_controller_set_rdm_cmd_callbacks(RdmnetControllerConfig *config, RdmnetControllerRdmCommandReceivedCallback rdm_command_received, RdmnetControllerLlrpRdmCommandReceivedCallback llrp_rdm_command_received, uint8_t *response_buf, void *context)</div><div class="ttdoc">Set callbacks to handle RDM commands in an RDMnet controller configuration structure.</div><div class="ttdef"><b>Definition:</b> controller.c:225</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_14_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyControllerRdmCommandHandler : <span class="keyword">public</span> <a class="code" href="classrdmnet_1_1_controller_1_1_rdm_command_handler.html">rdmnet::Controller::RdmCommandHandler</a></div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Implement the RdmCommandHandler functions...</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">MyControllerRdmCommandHandler my_rdm_cmd_handler;</div>
<div class="line"><a class="code" href="structrdmnet_1_1_controller_1_1_settings.html">rdmnet::Controller::Settings</a> my_settings(my_cid, MY_ESTA_MANUFACTURER_ID_VAL);</div>
<div class="line"> </div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPalDocs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = controller.<a class="code" href="classrdmnet_1_1_controller.html#a25e1aa54e8c33ac84c6346bdd4faf36a">Startup</a>(my_controller_notify_handler, my_settings, my_rdm_cmd_handler);</div>
<div class="ttc" id="aclassrdmnet_1_1_controller_1_1_rdm_command_handler_html"><div class="ttname"><a href="classrdmnet_1_1_controller_1_1_rdm_command_handler.html">rdmnet::Controller::RdmCommandHandler</a></div><div class="ttdoc">A base class for a class that receives RDM commands addressed to a controller.</div><div class="ttdef"><b>Definition:</b> controller.h:153</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>See <a class="el" href="handling_rdm_commands.html">Handling RDM Commands</a> for information about how to handle commands through the callbacks. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="getting_started.html">Getting Started</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
