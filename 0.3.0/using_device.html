<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RDMnet: Using the Device API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="etclibtool.css" rel="stylesheet" type="text/css"/>
<link href="rdmnet_dox_styles.css" rel="stylesheet" type="text/css"/>
<!-- BEGIN CUSTOM SCRIPTS -->
<!-- BEGIN ETCLIBTOOL VERSION SELECTOR SCRIPT -->
<script type="text/javascript">
  $(function () {
    $.get('/RDMnetDocs/versions.txt', function (data) {
      if (data) {
        var lines = data.split('\n');
        if (lines.length > 0) {
          var version_select = $("#version_select").empty();
          lines.forEach(function (line) {
            line = line.trim();
            if (!line) {
              return;
            }
            line = line.split(':');
            var option_name = line[0].replace(/^v/, '');
            if (line.length > 1) {
              option_name += ' (' + line[1] + ')';
            }
            var option_val = '/RDMnetDocs/' + line[0];
            var option = $('<option></option>').attr("value", option_val)
              .text(option_name);
            if (window.location.pathname.match(line[0])) {
              option = option.attr("selected", "selected");
            }
            version_select.append(option);
          });
        }
      }
    }, 'text');
  });
</script>
<!-- END ETCLIBTOOL VERSION SELECTOR SCRIPT -->
<script type="text/javascript">
  $(function () { selectAllC() });
</script>
<script type="text/javascript">
  function selectAllC() {
    // Enable all C-language blocks
    var tabcontent = document.getElementsByClassName("code-tab-content");
    for (i = 0; i < tabcontent.length; i++) {
      if (tabcontent[i].id.endsWith("_c")) {
        tabcontent[i].style.display = "block";
      } else {
        tabcontent[i].style.display = "none"
      }
    }
    // Enable all C-language buttons
    var tablinks = document.getElementsByClassName("code-tab-links");
    for (i = 0; i < tablinks.length; i++) {
      if (tablinks[i].id.endsWith("_c")) {
        if (!tablinks[i].className.includes("active")) {
          tablinks[i].className = tablinks[i].className += " active";
        }
      } else {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
    }
  }
  function selectAllCpp() {
    // Enable all C++-language blocks
    var tabcontent = document.getElementsByClassName("code-tab-content");
    for (i = 0; i < tabcontent.length; i++) {
      if (tabcontent[i].id.endsWith("_cpp")) {
        tabcontent[i].style.display = "block";
      } else {
        tabcontent[i].style.display = "none"
      }
    }
    // Enable all C++-language buttons
    var tablinks = document.getElementsByClassName("code-tab-links");
    for (i = 0; i < tablinks.length; i++) {
      if (tablinks[i].id.endsWith("_cpp")) {
        if (!tablinks[i].className.includes("active")) {
          tablinks[i].className = tablinks[i].className += " active";
        }
      } else {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
    }
  }
  function selectLanguage(evt, block_id, language) {
    // Get all elements with class="tabcontent" and hide them
    var tabcontent = document.getElementsByClassName("code-tab-content");
    for (i = 0; i < tabcontent.length; i++) {
      if (tabcontent[i].id.startsWith("div_" + block_id)) {
        tabcontent[i].style.display = "none";
      }
    }
    // Get all elements with class="tablinks" and remove the class "active"
    var tablinks = document.getElementsByClassName("code-tab-links");
    for (i = 0; i < tablinks.length; i++) {
      if (tablinks[i].id.startsWith("button_" + block_id)) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
    }
    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById("div_" + block_id + "_" + language).style.display = "block";
    if (!evt.currentTarget.className.includes("active")) {
      evt.currentTarget.className += " active";
    }
  }
</script>
<!-- END CUSTOM SCRIPTS -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RDMnet
   &#160;<span id="projectnumber">0.3.0</span>
   </div>
   <div id="projectbrief">Implementation of ANSI E1.33 (RDMnet)</div>
  </td>
  <!-- BEGIN VERSION SELECTOR INSERTED BY ETCLIBTOOL -->
  <td style="text-align: right; padding-right: 0.5em">
    <div id="otherversions">
      View other versions:
      <select id="version_select" onchange="location = this.value">
      </select>
    </div>
  </td>
  <!-- END VERSION SELECTOR INSERTED BY ETCLIBTOOL -->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('using_device.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using the Device API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__tmp_tmp4mu2ox95_docs_getting_started_using_device"></a> The RDMnet Device API exposes both a C and C++ language interface. The C++ interface is a header-only wrapper around the C interface.</p>
<p> 
<div class="code-tab-page-selector">
  <button id="button_1_c" class="code-tab-links" onclick="selectAllC()">Show All C Snippets</button>
  <button id="button_1_cpp" class="code-tab-links" onclick="selectAllCpp()">Show All C++ Snippets</button>
</div>
</p>
<h1>Initialization</h1>
<p>The RDMnet library must be globally initialized before using the RDMnet Device API. See <a class="el" href="global_init_and_destroy.html">Global Initialization and Destruction</a>.</p>
<p>To create a device instance, use the <a class="el" href="group__rdmnet__device.html#gaeed7f09d54c4f10901ab68a7c3df5fdd" title="Create a new instance of RDMnet device functionality.">rdmnet_device_create()</a> function in C, or instantiate an <a class="el" href="classrdmnet_1_1_device.html" title="An instance of RDMnet device functionality.">rdmnet::Device</a> and call its Startup() function in C++.</p>
<p>The RDMnet device API is an asynchronous, callback-oriented API. Part of the initial configuration for a device instance is a set of function pointers (or abstract interface) for the library to use as callbacks. Callbacks are dispatched from the background thread that is started when the RDMnet library is initialized.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_2_c" class="code-tab-links" onclick="selectLanguage(event, '2', 'c')">C</button>
  <button id="button_2_cpp" class="code-tab-links" onclick="selectLanguage(event, '2', 'cpp')">C++</button>
</div>
<div id="div_2_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="device_8h.html">rdmnet/device.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Sets optional values to defaults. Must pass your ESTA manufacturer ID. If you have not yet</span></div>
<div class="line"><span class="comment">// requested an ESTA manufacturer ID, the range 0x7ff0 to 0x7fff can be used for prototyping.</span></div>
<div class="line"><a class="code" href="struct_rdmnet_device_config.html">RdmnetDeviceConfig</a> config = <a class="code" href="group__rdmnet__device.html#gac8e03e329deb576755450ed19c0d5ca8">RDMNET_DEVICE_CONFIG_DEFAULT_INIT</a>(MY_ESTA_MANUFACTURER_ID_VAL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Each device is a component that must have a Component ID (CID), which is simply a UUID. Pure</span></div>
<div class="line"><span class="comment">// redistributable software apps may generate a new CID on each run, but hardware-locked devices</span></div>
<div class="line"><span class="comment">// should use a consistent CID locked to a MAC address (a V3 or V5 UUID).</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#ga1a5104de6a3c54113edf234e0840dcda">etcpal_generate_device_uuid</a>(<span class="stringliteral">&quot;My Device Name&quot;</span>, &amp;device_mac_addr, 0, &amp;config.<a class="code" href="struct_rdmnet_device_config.html#ae68596928501f9b5f49882a35470d6dc">cid</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set the callback functions - defined elsewhere</span></div>
<div class="line"><span class="comment">// p_some_opaque_data is an opaque data pointer that will be passed back to each callback function</span></div>
<div class="line"><a class="code" href="group__rdmnet__device.html#ga420e494f9989ee6f1add982049b35050">rdmnet_device_set_callbacks</a>(&amp;config, my_device_connected_cb, my_device_connect_failed_cb,</div>
<div class="line">                            my_device_disconnected_cb, my_device_rdm_command_received_cb,</div>
<div class="line">                            my_device_llrp_rdm_command_received_cb, p_some_opaque_data);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__rdmnet__device.html#gad17bb8836a86ad4c8a774cd94a01d63c">rdmnet_device_t</a> my_device_handle;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__device.html#gaeed7f09d54c4f10901ab68a7c3df5fdd">rdmnet_device_create</a>(&amp;config, &amp;my_device_handle);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Handle is valid and may be referenced in later calls to API functions.</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Some error occurred, handle is not valid.</span></div>
<div class="line">}</div>
<div class="ttc" id="adevice_8h_html"><div class="ttname"><a href="device_8h.html">device.h</a></div><div class="ttdoc">Definitions for the RDMnet Device API.</div></div>
<div class="ttc" id="agroup__etcpal__error_html_ga743b0648f0ca798ef29c9f69c6e255af"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a></div><div class="ttdeci">etcpal_error_t</div></div>
<div class="ttc" id="agroup__etcpal__error_html_gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a></div><div class="ttdeci">kEtcPalErrOk</div></div>
<div class="ttc" id="agroup__etcpal__uuid_html_ga1a5104de6a3c54113edf234e0840dcda"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#ga1a5104de6a3c54113edf234e0840dcda">etcpal_generate_device_uuid</a></div><div class="ttdeci">etcpal_error_t etcpal_generate_device_uuid(const char *dev_str, const uint8_t *mac_addr, uint32_t uuid_num, EtcPalUuid *uuid)</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_ga420e494f9989ee6f1add982049b35050"><div class="ttname"><a href="group__rdmnet__device.html#ga420e494f9989ee6f1add982049b35050">rdmnet_device_set_callbacks</a></div><div class="ttdeci">void rdmnet_device_set_callbacks(RdmnetDeviceConfig *config, RdmnetDeviceConnectedCallback connected, RdmnetDeviceConnectFailedCallback connect_failed, RdmnetDeviceDisconnectedCallback disconnected, RdmnetDeviceRdmCommandReceivedCallback rdm_command_received, RdmnetDeviceLlrpRdmCommandReceivedCallback llrp_rdm_command_received, RdmnetDeviceDynamicUidStatusCallback dynamic_uid_status_received, void *context)</div><div class="ttdoc">Set the main callbacks in an RDMnet device configuration structure.</div><div class="ttdef"><b>Definition:</b> device.c:182</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_gac8e03e329deb576755450ed19c0d5ca8"><div class="ttname"><a href="group__rdmnet__device.html#gac8e03e329deb576755450ed19c0d5ca8">RDMNET_DEVICE_CONFIG_DEFAULT_INIT</a></div><div class="ttdeci">#define RDMNET_DEVICE_CONFIG_DEFAULT_INIT(manu_id)</div><div class="ttdoc">A default-value initializer for an RdmnetDeviceConfig struct.</div><div class="ttdef"><b>Definition:</b> device.h:297</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_gad17bb8836a86ad4c8a774cd94a01d63c"><div class="ttname"><a href="group__rdmnet__device.html#gad17bb8836a86ad4c8a774cd94a01d63c">rdmnet_device_t</a></div><div class="ttdeci">int rdmnet_device_t</div><div class="ttdoc">A handle to an RDMnet device.</div><div class="ttdef"><b>Definition:</b> device.h:53</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_gaeed7f09d54c4f10901ab68a7c3df5fdd"><div class="ttname"><a href="group__rdmnet__device.html#gaeed7f09d54c4f10901ab68a7c3df5fdd">rdmnet_device_create</a></div><div class="ttdeci">etcpal_error_t rdmnet_device_create(const RdmnetDeviceConfig *config, rdmnet_device_t *handle)</div><div class="ttdoc">Create a new instance of RDMnet device functionality.</div><div class="ttdef"><b>Definition:</b> device.c:219</div></div>
<div class="ttc" id="astruct_rdmnet_device_config_html"><div class="ttname"><a href="struct_rdmnet_device_config.html">RdmnetDeviceConfig</a></div><div class="ttdoc">A set of information that defines the startup parameters of an RDMnet Device.</div><div class="ttdef"><b>Definition:</b> device.h:227</div></div>
<div class="ttc" id="astruct_rdmnet_device_config_html_ae68596928501f9b5f49882a35470d6dc"><div class="ttname"><a href="struct_rdmnet_device_config.html#ae68596928501f9b5f49882a35470d6dc">RdmnetDeviceConfig::cid</a></div><div class="ttdeci">EtcPalUuid cid</div><div class="ttdoc">The device's CID.</div><div class="ttdef"><b>Definition:</b> device.h:233</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_2_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cpp_2device_8h.html">rdmnet/cpp/device.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MyDeviceNotifyHandler : <span class="keyword">public</span> <a class="code" href="classrdmnet_1_1_device_1_1_notify_handler.html">rdmnet::Device::NotifyHandler</a></div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Implement the NotifyHandler callbacks...</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">MyDeviceNotifyHandler my_device_notify_handler;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Example method for generating a CID for a hardware-locked device:</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_uuid.html">etcpal::Uuid</a> my_cid = <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_uuid.html#a30a2f58b68d4d0e7d2ae6a63213a388a">etcpal::Uuid::Device</a>(<span class="stringliteral">&quot;My Device Name&quot;</span>, device_mac_addr, 0);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structrdmnet_1_1_device_1_1_settings.html">rdmnet::Device::Settings</a> settings(my_cid, MY_ESTA_MANUFACTURER_ID_VAL);</div>
<div class="line"><a class="code" href="classrdmnet_1_1_device.html">rdmnet::Device</a> device;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// In this example we are using the convenience method to startup with the default scope. The</span></div>
<div class="line"><span class="comment">// Startup() overloads can be used to specify a scope to start on.</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#afe17981d3035416d657b269ad2034960">StartupWithDefaultScope</a>(my_device_notify_handler, settings);</div>
<div class="line"><span class="keywordflow">if</span> (result)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Device is valid and running.</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;RDMnet device startup failed with error: &quot;</span> &lt;&lt; result.<a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html#a19c380b03cea21d7ac7325136a131ff0">ToString</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">}</div>
<div class="ttc" id="aclassetcpal_1_1_error_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a></div></div>
<div class="ttc" id="aclassetcpal_1_1_error_html_a19c380b03cea21d7ac7325136a131ff0"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html#a19c380b03cea21d7ac7325136a131ff0">etcpal::Error::ToString</a></div><div class="ttdeci">std::string ToString() const</div></div>
<div class="ttc" id="aclassetcpal_1_1_uuid_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_uuid.html">etcpal::Uuid</a></div></div>
<div class="ttc" id="aclassetcpal_1_1_uuid_html_a30a2f58b68d4d0e7d2ae6a63213a388a"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_uuid.html#a30a2f58b68d4d0e7d2ae6a63213a388a">etcpal::Uuid::Device</a></div><div class="ttdeci">static Uuid Device(const std::string &amp;device_str, const uint8_t *mac_addr, uint32_t uuid_num) noexcept</div></div>
<div class="ttc" id="aclassrdmnet_1_1_device_1_1_notify_handler_html"><div class="ttname"><a href="classrdmnet_1_1_device_1_1_notify_handler.html">rdmnet::Device::NotifyHandler</a></div><div class="ttdoc">A base class for a class that receives notification callbacks from a device.</div><div class="ttdef"><b>Definition:</b> device.h:327</div></div>
<div class="ttc" id="aclassrdmnet_1_1_device_html"><div class="ttname"><a href="classrdmnet_1_1_device.html">rdmnet::Device</a></div><div class="ttdoc">An instance of RDMnet device functionality.</div><div class="ttdef"><b>Definition:</b> device.h:315</div></div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_afe17981d3035416d657b269ad2034960"><div class="ttname"><a href="classrdmnet_1_1_device.html#afe17981d3035416d657b269ad2034960">rdmnet::Device::StartupWithDefaultScope</a></div><div class="ttdeci">etcpal::Error StartupWithDefaultScope(NotifyHandler &amp;notify_handler, const Settings &amp;settings, const etcpal::SockAddr &amp;static_broker_addr=etcpal::SockAddr{})</div><div class="ttdoc">Allocate resources and start up this device with the given configuration on the default RDMnet scope.</div><div class="ttdef"><b>Definition:</b> device.h:606</div></div>
<div class="ttc" id="acpp_2device_8h_html"><div class="ttname"><a href="cpp_2device_8h.html">device.h</a></div><div class="ttdoc">C++ wrapper for the RDMnet Device API.</div></div>
<div class="ttc" id="astructrdmnet_1_1_device_1_1_settings_html"><div class="ttname"><a href="structrdmnet_1_1_device_1_1_settings.html">rdmnet::Device::Settings</a></div><div class="ttdoc">A set of configuration settings that a device needs to initialize.</div><div class="ttdef"><b>Definition:</b> device.h:378</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Deinitialization</h1>
<p>The device should be shut down and destroyed gracefully before program termination. This will send a graceful disconnect message to any connected broker and deallocate the device's resources.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_3_c" class="code-tab-links" onclick="selectLanguage(event, '3', 'c')">C</button>
  <button id="button_3_cpp" class="code-tab-links" onclick="selectLanguage(event, '3', 'cpp')">C++</button>
</div>
<div id="div_3_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="code" href="group__rdmnet__device.html#ga11d7eec0a099562a80d9243d8c08042c">rdmnet_device_destroy</a>(my_device_handle, <a class="code" href="group__rdmnet__api__common.html#gga3eb1adaf6e830a807d1dcfbc64197222a336a46d8d36f5b1f32fac4653913cdd2">kRdmnetDisconnectShutdown</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// At this point, the device is no longer running and its handle is no longer valid.</span></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gga3eb1adaf6e830a807d1dcfbc64197222a336a46d8d36f5b1f32fac4653913cdd2"><div class="ttname"><a href="group__rdmnet__api__common.html#gga3eb1adaf6e830a807d1dcfbc64197222a336a46d8d36f5b1f32fac4653913cdd2">kRdmnetDisconnectShutdown</a></div><div class="ttdeci">@ kRdmnetDisconnectShutdown</div><div class="ttdoc">The remote component is shutting down.</div><div class="ttdef"><b>Definition:</b> common.h:87</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_ga11d7eec0a099562a80d9243d8c08042c"><div class="ttname"><a href="group__rdmnet__device.html#ga11d7eec0a099562a80d9243d8c08042c">rdmnet_device_destroy</a></div><div class="ttdeci">etcpal_error_t rdmnet_device_destroy(rdmnet_device_t handle, rdmnet_disconnect_reason_t disconnect_reason)</div><div class="ttdoc">Destroy a device instance.</div><div class="ttdef"><b>Definition:</b> device.c:257</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_3_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line">device.<a class="code" href="classrdmnet_1_1_device.html#a84538ed8fcb63d968c760649df74c61c">Shutdown</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// At this point, the device is no longer running and its handle is no longer valid. It can be</span></div>
<div class="line"><span class="comment">// started again (with a new handle) by calling Startup() again.</span></div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_a84538ed8fcb63d968c760649df74c61c"><div class="ttname"><a href="classrdmnet_1_1_device.html#a84538ed8fcb63d968c760649df74c61c">rdmnet::Device::Shutdown</a></div><div class="ttdeci">void Shutdown(rdmnet_disconnect_reason_t disconnect_reason=kRdmnetDisconnectShutdown)</div><div class="ttdoc">Shut down this device and deallocate resources.</div><div class="ttdef"><b>Definition:</b> device.h:664</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Managing Scopes</h1>
<p>Devices operate on a single RDMnet scope at a time, which is set at initial configuration time when the device instance is created, and can be changed using <a class="el" href="group__rdmnet__device.html#ga632bb5b71db04e29a77193ecd33b90d5" title="Change the device&#39;s scope.">rdmnet_device_change_scope()</a>. See the "Scopes" section in <a class="el" href="how_it_works.html">How RDMnet Works</a> for more information on scopes.</p>
<p>On startup, a device will immediately begin the scope connection state machine from the RDMnet tick thread. If a static configuration is not provided (using the <a class="el" href="group__rdmnet__api__common.html#ga0b906d1d6ed5fcc678e9c530e440b62f" title="Initialize an RdmnetScopeConfig struct with a scope string.">RDMNET_CLIENT_SET_SCOPE()</a> macro to initialize the device's <a class="el" href="struct_rdmnet_scope_config.html" title="A set of configuration information for a single scope in which an RDMnet client is participating.">RdmnetScopeConfig</a>, or calling <a class="el" href="classrdmnet_1_1_device.html#ab4573244d38d30c40900484f53b9fbe7" title="Allocate resources and start up this device with the given configuration on the given RDMnet scope.">rdmnet::Device::Startup()</a> without a static_broker_addr argument), the first action will be to attempt to discover brokers for this scope via DNS-SD. Once a broker is found, connection will be initiated automatically, and the result will be delivered via either the connected or connect_failed callback.</p>
<p>If a broker for a given scope has been configured with a static IP address and port, you can skip DNS-SD discovery by providing this address to the relevant functions/macros.</p>
<p>You can change the initial scope configuration before the device is started:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_4_c" class="code-tab-links" onclick="selectLanguage(event, '4', 'c')">C</button>
  <button id="button_4_cpp" class="code-tab-links" onclick="selectLanguage(event, '4', 'cpp')">C++</button>
</div>
<div id="div_4_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="code" href="struct_rdmnet_device_config.html">RdmnetDeviceConfig</a> config = <a class="code" href="group__rdmnet__device.html#gac8e03e329deb576755450ed19c0d5ca8">RDMNET_DEVICE_CONFIG_DEFAULT_INIT</a>(MY_ESTA_MANUFACTURER_ID_VAL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Edit the scope information in the configuration struct</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga0b906d1d6ed5fcc678e9c530e440b62f">RDMNET_CLIENT_SET_SCOPE</a>(&amp;config.<a class="code" href="struct_rdmnet_device_config.html#a4e5acc99018738e60e1de429f581cdf7">scope_config</a>, <span class="stringliteral">&quot;My initial scope&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Or, if configured with a static broker address...</span></div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga500c0af02a2db3a6b835f26cf304da85">RDMNET_CLIENT_SET_STATIC_SCOPE</a>(&amp;config.<a class="code" href="struct_rdmnet_device_config.html#a4e5acc99018738e60e1de429f581cdf7">scope_config</a>, <span class="stringliteral">&quot;My initial scope&quot;</span>, static_broker_addr);</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga0b906d1d6ed5fcc678e9c530e440b62f"><div class="ttname"><a href="group__rdmnet__api__common.html#ga0b906d1d6ed5fcc678e9c530e440b62f">RDMNET_CLIENT_SET_SCOPE</a></div><div class="ttdeci">#define RDMNET_CLIENT_SET_SCOPE(configptr, scope_str)</div><div class="ttdoc">Initialize an RdmnetScopeConfig struct with a scope string.</div><div class="ttdef"><b>Definition:</b> client.h:262</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga500c0af02a2db3a6b835f26cf304da85"><div class="ttname"><a href="group__rdmnet__api__common.html#ga500c0af02a2db3a6b835f26cf304da85">RDMNET_CLIENT_SET_STATIC_SCOPE</a></div><div class="ttdeci">#define RDMNET_CLIENT_SET_STATIC_SCOPE(configptr, scope_str, broker_addr)</div><div class="ttdoc">Initialize an RdmnetScopeConfig struct with a scope string and static broker address.</div><div class="ttdef"><b>Definition:</b> client.h:295</div></div>
<div class="ttc" id="astruct_rdmnet_device_config_html_a4e5acc99018738e60e1de429f581cdf7"><div class="ttname"><a href="struct_rdmnet_device_config.html#a4e5acc99018738e60e1de429f581cdf7">RdmnetDeviceConfig::scope_config</a></div><div class="ttdeci">RdmnetScopeConfig scope_config</div><div class="ttdoc">(optional) The device's configured RDMnet scope.</div><div class="ttdef"><b>Definition:</b> device.h:251</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_4_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#ab4573244d38d30c40900484f53b9fbe7">Startup</a>(my_device_notify_handler, settings, <span class="stringliteral">&quot;My initial scope&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Or, if configured with a static broker address...</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#ab4573244d38d30c40900484f53b9fbe7">Startup</a>(my_device_notify_handler, settings, <span class="stringliteral">&quot;My initial scope&quot;</span>, my_static_broker_addr);</div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_ab4573244d38d30c40900484f53b9fbe7"><div class="ttname"><a href="classrdmnet_1_1_device.html#ab4573244d38d30c40900484f53b9fbe7">rdmnet::Device::Startup</a></div><div class="ttdeci">etcpal::Error Startup(NotifyHandler &amp;notify_handler, const Settings &amp;settings, const char *scope_id_str, const etcpal::SockAddr &amp;static_broker_addr=etcpal::SockAddr{})</div><div class="ttdoc">Allocate resources and start up this device with the given configuration on the given RDMnet scope.</div><div class="ttdef"><b>Definition:</b> device.h:629</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>Or change the scope while the device is running. This will cause the device to disconnect from the old scope and connect to the new one.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_5_c" class="code-tab-links" onclick="selectLanguage(event, '5', 'c')">C</button>
  <button id="button_5_cpp" class="code-tab-links" onclick="selectLanguage(event, '5', 'cpp')">C++</button>
</div>
<div id="div_5_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><a class="code" href="struct_rdmnet_scope_config.html">RdmnetScopeConfig</a> new_scope_config;</div>
<div class="line"><a class="code" href="group__rdmnet__api__common.html#ga0b906d1d6ed5fcc678e9c530e440b62f">RDMNET_CLIENT_SET_SCOPE</a>(&amp;new_scope_config, <span class="stringliteral">&quot;My new scope&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The disconnect_reason argument provides the RDMnet disconnect reason code to send on the current</span></div>
<div class="line"><span class="comment">// connected scope. Select the most appropriate value for why the scope is changing.</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__device.html#ga632bb5b71db04e29a77193ecd33b90d5">rdmnet_device_change_scope</a>(my_device_handle, &amp;new_scope_config, <a class="code" href="group__rdmnet__api__common.html#gga3eb1adaf6e830a807d1dcfbc64197222a25de5a2953a7a4ae379975bb300d8165">kRdmnetDisconnectUserReconfigure</a>);</div>
<div class="ttc" id="agroup__rdmnet__api__common_html_gga3eb1adaf6e830a807d1dcfbc64197222a25de5a2953a7a4ae379975bb300d8165"><div class="ttname"><a href="group__rdmnet__api__common.html#gga3eb1adaf6e830a807d1dcfbc64197222a25de5a2953a7a4ae379975bb300d8165">kRdmnetDisconnectUserReconfigure</a></div><div class="ttdeci">@ kRdmnetDisconnectUserReconfigure</div><div class="ttdoc">The component was reconfigured via some other means, and the new configuration requires connection te...</div><div class="ttdef"><b>Definition:</b> common.h:112</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_ga632bb5b71db04e29a77193ecd33b90d5"><div class="ttname"><a href="group__rdmnet__device.html#ga632bb5b71db04e29a77193ecd33b90d5">rdmnet_device_change_scope</a></div><div class="ttdeci">etcpal_error_t rdmnet_device_change_scope(rdmnet_device_t handle, const RdmnetScopeConfig *new_scope_config, rdmnet_disconnect_reason_t disconnect_reason)</div><div class="ttdoc">Change the device's scope.</div><div class="ttdef"><b>Definition:</b> device.c:1154</div></div>
<div class="ttc" id="astruct_rdmnet_scope_config_html"><div class="ttname"><a href="struct_rdmnet_scope_config.html">RdmnetScopeConfig</a></div><div class="ttdoc">A set of configuration information for a single scope in which an RDMnet client is participating.</div><div class="ttdef"><b>Definition:</b> client.h:224</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_5_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// The disconnect_reason argument provides the RDMnet disconnect reason code to send on the current</span></div>
<div class="line"><span class="comment">// connected scope. Select the most appropriate value for why the scope is changing.</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#a9f0e9d76c4ce0487b0fd38edec014fe4">ChangeScope</a>(<span class="stringliteral">&quot;My new scope&quot;</span>, <a class="code" href="group__rdmnet__api__common.html#gga3eb1adaf6e830a807d1dcfbc64197222a25de5a2953a7a4ae379975bb300d8165">kRdmnetDisconnectUserReconfigure</a>);</div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_a9f0e9d76c4ce0487b0fd38edec014fe4"><div class="ttname"><a href="classrdmnet_1_1_device.html#a9f0e9d76c4ce0487b0fd38edec014fe4">rdmnet::Device::ChangeScope</a></div><div class="ttdeci">etcpal::Error ChangeScope(const char *new_scope_id_str, rdmnet_disconnect_reason_t disconnect_reason, const etcpal::SockAddr &amp;static_broker_addr=etcpal::SockAddr{})</div><div class="ttdoc">Change the device's RDMnet scope.</div><div class="ttdef"><b>Definition:</b> device.h:683</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h1>Handling Callbacks</h1>
<p>The library will dispatch callback notifications from the background thread which is started when <a class="el" href="group__rdmnet__api__common.html#gac35e678c3cc099a73e9314614215e1d8" title="Initialize the RDMnet library.">rdmnet_init()</a> is called. It is safe to call any RDMnet API function from any callback.</p>
<p>Generally the first callback a device gets will be when it has connected to a broker:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_6_c" class="code-tab-links" onclick="selectLanguage(event, '6', 'c')">C</button>
  <button id="button_6_cpp" class="code-tab-links" onclick="selectLanguage(event, '6', 'cpp')">C++</button>
</div>
<div id="div_6_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> device_connected_callback(<a class="code" href="group__rdmnet__device.html#gad17bb8836a86ad4c8a774cd94a01d63c">rdmnet_device_t</a> handle, <span class="keyword">const</span> <a class="code" href="struct_rdmnet_client_connected_info.html">RdmnetClientConnectedInfo</a>* info, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> addr_str[<a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__inet.html#gacd7ec0d81e171166483c7629669bf05d">ETCPAL_IP_STRING_BYTES</a>];</div>
<div class="line">  <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__inet.html#gaf98da0ae21f7960b5e046c55b8d79c4a">etcpal_ip_to_string</a>(&amp;info-&gt;<a class="code" href="struct_rdmnet_client_connected_info.html#a39d671dfd8919b93fe23dba6dbfba905">broker_addr</a>.<a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/struct_etc_pal_sock_addr.html#a19cc8016f534a565f984438cfe911a9e">ip</a>, addr_str);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Connected to broker &#39;%s&#39; at address %s:%d\n&quot;</span>, info-&gt;<a class="code" href="struct_rdmnet_client_connected_info.html#a09b4687edadab4b4334a33b38d00cf2f">broker_name</a>, addr_str, info-&gt;<a class="code" href="struct_rdmnet_client_connected_info.html#a39d671dfd8919b93fe23dba6dbfba905">broker_addr</a>.<a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/struct_etc_pal_sock_addr.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__etcpal__inet_html_gacd7ec0d81e171166483c7629669bf05d"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__inet.html#gacd7ec0d81e171166483c7629669bf05d">ETCPAL_IP_STRING_BYTES</a></div><div class="ttdeci">#define ETCPAL_IP_STRING_BYTES</div></div>
<div class="ttc" id="agroup__etcpal__inet_html_gaf98da0ae21f7960b5e046c55b8d79c4a"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__inet.html#gaf98da0ae21f7960b5e046c55b8d79c4a">etcpal_ip_to_string</a></div><div class="ttdeci">etcpal_error_t etcpal_ip_to_string(const EtcPalIpAddr *src, char *dest)</div></div>
<div class="ttc" id="astruct_etc_pal_sock_addr_html_a19cc8016f534a565f984438cfe911a9e"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/struct_etc_pal_sock_addr.html#a19cc8016f534a565f984438cfe911a9e">EtcPalSockAddr::ip</a></div><div class="ttdeci">EtcPalIpAddr ip</div></div>
<div class="ttc" id="astruct_etc_pal_sock_addr_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/struct_etc_pal_sock_addr.html#a8e0798404bf2cf5dabb84c5ba9a4f236">EtcPalSockAddr::port</a></div><div class="ttdeci">uint16_t port</div></div>
<div class="ttc" id="astruct_rdmnet_client_connected_info_html"><div class="ttname"><a href="struct_rdmnet_client_connected_info.html">RdmnetClientConnectedInfo</a></div><div class="ttdoc">Information provided by the library about a successful RDMnet client connection.</div><div class="ttdef"><b>Definition:</b> client.h:151</div></div>
<div class="ttc" id="astruct_rdmnet_client_connected_info_html_a09b4687edadab4b4334a33b38d00cf2f"><div class="ttname"><a href="struct_rdmnet_client_connected_info.html#a09b4687edadab4b4334a33b38d00cf2f">RdmnetClientConnectedInfo::broker_name</a></div><div class="ttdeci">const char * broker_name</div><div class="ttdoc">The DNS name of the broker, if it was discovered using DNS-SD; otherwise an empty string.</div><div class="ttdef"><b>Definition:</b> client.h:155</div></div>
<div class="ttc" id="astruct_rdmnet_client_connected_info_html_a39d671dfd8919b93fe23dba6dbfba905"><div class="ttname"><a href="struct_rdmnet_client_connected_info.html#a39d671dfd8919b93fe23dba6dbfba905">RdmnetClientConnectedInfo::broker_addr</a></div><div class="ttdeci">EtcPalSockAddr broker_addr</div><div class="ttdoc">The IP address and port of the remote broker to which we have connected.</div><div class="ttdef"><b>Definition:</b> client.h:153</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_6_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyDeviceNotifyHandler::HandleConnectedToBroker(<a class="code" href="classrdmnet_1_1_device.html#a7e0d6654da08564c996e6518ebe5def9">rdmnet::Device::Handle</a> handle,</div>
<div class="line">                                                    <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_client_connected_info.html">rdmnet::ClientConnectedInfo</a>&amp; info)</div>
<div class="line">{</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Connected to broker &#39;&quot;</span> &lt;&lt; info.<a class="code" href="classrdmnet_1_1_client_connected_info.html#a751d070cb4c1f89d838955298270b6cf">broker_name</a>()</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;&#39; at IP address &quot;</span> &lt;&lt; info.<a class="code" href="classrdmnet_1_1_client_connected_info.html#af30653fa66bd5b267c54cf81a8c7eb3d">broker_addr</a>().<a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_sock_addr.html#a19c380b03cea21d7ac7325136a131ff0">ToString</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">}</div>
<div class="ttc" id="aclassetcpal_1_1_sock_addr_html_a19c380b03cea21d7ac7325136a131ff0"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_sock_addr.html#a19c380b03cea21d7ac7325136a131ff0">etcpal::SockAddr::ToString</a></div><div class="ttdeci">std::string ToString() const</div></div>
<div class="ttc" id="aclassrdmnet_1_1_client_connected_info_html"><div class="ttname"><a href="classrdmnet_1_1_client_connected_info.html">rdmnet::ClientConnectedInfo</a></div><div class="ttdoc">Information about a successful connection to a broker delivered to an RDMnet callback function.</div><div class="ttdef"><b>Definition:</b> client.h:149</div></div>
<div class="ttc" id="aclassrdmnet_1_1_client_connected_info_html_a751d070cb4c1f89d838955298270b6cf"><div class="ttname"><a href="classrdmnet_1_1_client_connected_info.html#a751d070cb4c1f89d838955298270b6cf">rdmnet::ClientConnectedInfo::broker_name</a></div><div class="ttdeci">std::string broker_name() const</div><div class="ttdoc">Get the DNS name of the broker (if it was discovered via DNS-SD; otherwise this will be an empty stri...</div><div class="ttdef"><b>Definition:</b> client.h:184</div></div>
<div class="ttc" id="aclassrdmnet_1_1_client_connected_info_html_af30653fa66bd5b267c54cf81a8c7eb3d"><div class="ttname"><a href="classrdmnet_1_1_client_connected_info.html#af30653fa66bd5b267c54cf81a8c7eb3d">rdmnet::ClientConnectedInfo::broker_addr</a></div><div class="ttdeci">constexpr etcpal::SockAddr broker_addr() const noexcept</div><div class="ttdoc">Get the IP address and port of the remote broker to which we have connected.</div><div class="ttdef"><b>Definition:</b> client.h:178</div></div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_a7e0d6654da08564c996e6518ebe5def9"><div class="ttname"><a href="classrdmnet_1_1_device.html#a7e0d6654da08564c996e6518ebe5def9">rdmnet::Device::Handle</a></div><div class="ttdeci">rdmnet_device_t Handle</div><div class="ttdoc">A handle type used by the RDMnet library to identify device instances.</div><div class="ttdef"><b>Definition:</b> device.h:318</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h2>Connection Failure</h2>
<p>It's worth noting connection failure as a special case here. RDMnet connections can fail for many reasons, including user misconfiguration, network misconfiguration, components starting up or shutting down, programming errors, and more.</p>
<p>The ClientConnectFailedInfo and ClientDisconnectedInfo structs passed back with the "connect failed" and "disconnected" callbacks respectively have comprehensive information about the failure, including enum values containing the library's categorization of the failure, protocol reason codes and socket errors where applicable. This information is typically used mostly for logging and debugging. Each of these codes has a respective <code>to_string()</code> function to aid in logging.</p>
<p>For programmatic use, the structs also contain a <code>will_retry</code> member which indicates whether the library plans to retry this connection in the background. The only circumstances under which the library will not retry is when a connection failure is determined to be either a programming error or a user misconfiguration. Some examples of these circumstances are:</p>
<ul>
<li>The broker explicitly rejected a connection with a reason code indicating a configuration error, such as <code>CONNECT_SCOPE_MISMATCH</code> or <code>CONNECT_DUPLICATE_UID</code>.</li>
<li>The library failed to create a network socket before the connection was initiated.</li>
</ul>
<h1>Adding Endpoints and Responders</h1>
<p>As explained in <a class="el" href="devices_and_gateways.html">Devices and Gateways</a>, RDMnet devices can contain endpoints which serve as grouping mechanisms for virtual or physical RDM responders. The RDMnet device API has functionality for managing endpoints and responders on a local device.</p>
<h2>Adding Physical Endpoints and Responders</h2>
<p>Physical endpoints are added using the physical endpoint configuration structure. This structure defines the endpoint number (an integer between 1 and 63,999) and any responders which are present on the endpoint initially.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_7_c" class="code-tab-links" onclick="selectLanguage(event, '7', 'c')">C</button>
  <button id="button_7_cpp" class="code-tab-links" onclick="selectLanguage(event, '7', 'cpp')">C++</button>
</div>
<div id="div_7_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Create a physical endpoint numbered 1, with no responders on it initially.</span></div>
<div class="line"><a class="code" href="struct_rdmnet_physical_endpoint_config.html">RdmnetPhysicalEndpointConfig</a> endpoint_config = <a class="code" href="group__rdmnet__device.html#gae49152ddbe7def8c181623e8a41590bb">RDMNET_PHYSICAL_ENDPOINT_INIT</a>(1);</div>
<div class="line"> </div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__device.html#ga669ad8832cd619410d3baa0b7cdcdee5">rdmnet_device_add_physical_endpoint</a>(my_device_handle, &amp;endpoint_config);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// The endpoint has been added. If currently connected, the library will send the proper</span></div>
<div class="line">  <span class="comment">// notification which indicates to connected controllers that there is a new endpoint present.</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__rdmnet__device_html_ga669ad8832cd619410d3baa0b7cdcdee5"><div class="ttname"><a href="group__rdmnet__device.html#ga669ad8832cd619410d3baa0b7cdcdee5">rdmnet_device_add_physical_endpoint</a></div><div class="ttdeci">etcpal_error_t rdmnet_device_add_physical_endpoint(rdmnet_device_t handle, const RdmnetPhysicalEndpointConfig *endpoint_config)</div><div class="ttdoc">Add a physical endpoint to a device.</div><div class="ttdef"><b>Definition:</b> device.c:512</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_gae49152ddbe7def8c181623e8a41590bb"><div class="ttname"><a href="group__rdmnet__device.html#gae49152ddbe7def8c181623e8a41590bb">RDMNET_PHYSICAL_ENDPOINT_INIT</a></div><div class="ttdeci">#define RDMNET_PHYSICAL_ENDPOINT_INIT(endpoint_num)</div><div class="ttdoc">An initializer for an RdmnetPhysicalEndpointConfig instance.</div><div class="ttdef"><b>Definition:</b> device.h:220</div></div>
<div class="ttc" id="astruct_rdmnet_physical_endpoint_config_html"><div class="ttname"><a href="struct_rdmnet_physical_endpoint_config.html">RdmnetPhysicalEndpointConfig</a></div><div class="ttdoc">Configuration information for a physical endpoint on a device.</div><div class="ttdef"><b>Definition:</b> device.h:198</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_7_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Endpoint configs are constructed implicitly from endpoint numbers, so when creating an endpoint</span></div>
<div class="line"><span class="comment">// with no responders on it initially, it&#39;s as simple as: </span></div>
<div class="line"> </div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#a875fae87db81a2fe2236566e45892f1b">AddPhysicalEndpoint</a>(1); <span class="comment">// Create a physical endpoint numbered 1</span></div>
<div class="line"><span class="keywordflow">if</span> (result)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// The endpoint has been added. If currently connected, the library will send the proper</span></div>
<div class="line">  <span class="comment">// notification which indicates to connected controllers that there is a new endpoint present.</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_a875fae87db81a2fe2236566e45892f1b"><div class="ttname"><a href="classrdmnet_1_1_device.html#a875fae87db81a2fe2236566e45892f1b">rdmnet::Device::AddPhysicalEndpoint</a></div><div class="ttdeci">etcpal::Error AddPhysicalEndpoint(const PhysicalEndpointConfig &amp;physical_config)</div><div class="ttdoc">Add a physical endpoint to a device.</div><div class="ttdef"><b>Definition:</b> device.h:909</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>Adding and removing physical responders from an endpoint will typically be done when an RDMnet gateway discovers or loses RDM responders on its RDM ports. For example:</p>
<p> 
<div class="code-tab-selector">
  <button id="button_8_c" class="code-tab-links" onclick="selectLanguage(event, '8', 'c')">C</button>
  <button id="button_8_cpp" class="code-tab-links" onclick="selectLanguage(event, '8', 'cpp')">C++</button>
</div>
<div id="div_8_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> rdm_responder_discovered(uint16_t port_endpoint_number, <span class="keyword">const</span> <a class="codeRef" href="https://etclabs.github.io/RDM/docs/head/struct_rdm_uid.html">RdmUid</a>* responder_uid, uint16_t control_field,</div>
<div class="line">                              <span class="keyword">const</span> <a class="codeRef" href="https://etclabs.github.io/RDM/docs/head/struct_rdm_uid.html">RdmUid</a>* binding_uid)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="struct_rdmnet_physical_endpoint_responder.html">RdmnetPhysicalEndpointResponder</a> new_responder;</div>
<div class="line">  new_responder.<a class="code" href="struct_rdmnet_physical_endpoint_responder.html#a4733eb56264b07b7459b7f9d8002cd94">uid</a> = *responder_uid;</div>
<div class="line">  new_responder.<a class="code" href="struct_rdmnet_physical_endpoint_responder.html#acf409850ecf2ca32dd2d999c602f00af">control_field</a> = control_field;</div>
<div class="line">  new_responder.<a class="code" href="struct_rdmnet_physical_endpoint_responder.html#aa4dd027426319d8717649c4aa0dd1bbf">binding_uid</a> = *binding_uid;</div>
<div class="line"> </div>
<div class="line">  <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__device.html#ga24588d30c5f1613587bf8dc3ecaa5e8c">rdmnet_device_add_physical_responders</a>(my_device_handle, port_endpoint_number,</div>
<div class="line">                                                                &amp;new_responder, 1);</div>
<div class="line">  <span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// The responder has been added. If currently connected, the library will send the proper</span></div>
<div class="line">    <span class="comment">// notification which indicates to connected controllers that there is a new responder present.</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__rdmnet__device_html_ga24588d30c5f1613587bf8dc3ecaa5e8c"><div class="ttname"><a href="group__rdmnet__device.html#ga24588d30c5f1613587bf8dc3ecaa5e8c">rdmnet_device_add_physical_responders</a></div><div class="ttdeci">etcpal_error_t rdmnet_device_add_physical_responders(rdmnet_device_t handle, uint16_t endpoint_id, const RdmnetPhysicalEndpointResponder *responders, size_t num_responders)</div><div class="ttdoc">Add one or more responders to a physical endpoint.</div><div class="ttdef"><b>Definition:</b> device.c:856</div></div>
<div class="ttc" id="astruct_rdm_uid_html"><div class="ttname"><a href="https://etclabs.github.io/RDM/docs/head/struct_rdm_uid.html">RdmUid</a></div></div>
<div class="ttc" id="astruct_rdmnet_physical_endpoint_responder_html"><div class="ttname"><a href="struct_rdmnet_physical_endpoint_responder.html">RdmnetPhysicalEndpointResponder</a></div><div class="ttdoc">Identifying information for a physical RDM responder connected to an RDMnet gateway.</div><div class="ttdef"><b>Definition:</b> device.h:181</div></div>
<div class="ttc" id="astruct_rdmnet_physical_endpoint_responder_html_a4733eb56264b07b7459b7f9d8002cd94"><div class="ttname"><a href="struct_rdmnet_physical_endpoint_responder.html#a4733eb56264b07b7459b7f9d8002cd94">RdmnetPhysicalEndpointResponder::uid</a></div><div class="ttdeci">RdmUid uid</div><div class="ttdoc">The responder's UID.</div><div class="ttdef"><b>Definition:</b> device.h:183</div></div>
<div class="ttc" id="astruct_rdmnet_physical_endpoint_responder_html_aa4dd027426319d8717649c4aa0dd1bbf"><div class="ttname"><a href="struct_rdmnet_physical_endpoint_responder.html#aa4dd027426319d8717649c4aa0dd1bbf">RdmnetPhysicalEndpointResponder::binding_uid</a></div><div class="ttdeci">RdmUid binding_uid</div><div class="ttdoc">The binding UID received in the DISC_MUTE message from this responder.</div><div class="ttdef"><b>Definition:</b> device.h:190</div></div>
<div class="ttc" id="astruct_rdmnet_physical_endpoint_responder_html_acf409850ecf2ca32dd2d999c602f00af"><div class="ttname"><a href="struct_rdmnet_physical_endpoint_responder.html#acf409850ecf2ca32dd2d999c602f00af">RdmnetPhysicalEndpointResponder::control_field</a></div><div class="ttdeci">uint16_t control_field</div><div class="ttdoc">The control field received in the DISC_MUTE message from this responder.</div><div class="ttdef"><b>Definition:</b> device.h:185</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_8_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> RdmResponderDiscovered(uint16_t port_endpoint_number, <span class="keyword">const</span> <a class="codeRef" href="https://etclabs.github.io/RDM/docs/head/classrdm_1_1_uid.html">rdm::Uid</a>&amp; responder_uid, uint16_t control_field,</div>
<div class="line">                            <span class="keyword">const</span> <a class="codeRef" href="https://etclabs.github.io/RDM/docs/head/classrdm_1_1_uid.html">rdm::Uid</a>&amp; binding_uid)</div>
<div class="line">{</div>
<div class="line">  <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#aa55f54189e6601365456952655cc1c4f">AddPhysicalResponder</a>(port_endpoint_number, responder_uid, control_field, binding_uid);</div>
<div class="line">  <span class="keywordflow">if</span> (result)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// The responder has been added. If currently connected, the library will send the proper</span></div>
<div class="line">    <span class="comment">// notification which indicates to connected controllers that there is a new responder present.</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassrdm_1_1_uid_html"><div class="ttname"><a href="https://etclabs.github.io/RDM/docs/head/classrdm_1_1_uid.html">rdm::Uid</a></div></div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_aa55f54189e6601365456952655cc1c4f"><div class="ttname"><a href="classrdmnet_1_1_device.html#aa55f54189e6601365456952655cc1c4f">rdmnet::Device::AddPhysicalResponder</a></div><div class="ttdeci">etcpal::Error AddPhysicalResponder(uint16_t endpoint_id, const rdm::Uid &amp;responder_uid, uint16_t control_field, const rdm::Uid &amp;binding_uid=rdm::Uid{})</div><div class="ttdoc">Add a responder to a physical endpoint.</div><div class="ttdef"><b>Definition:</b> device.h:1070</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>Note that the RDMnet library requires the control field (and optional binding UID) received in the DISC_MUTE message from a physical responder, so that controllers can fetch this information.</p>
<p>You can also add responders initially present on an endpoint at the same time as the endpoint is added. This should be done anytime the initial responders on an endpoint are known, as it reduces the volume of RDMnet messages that need to be sent.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_9_c" class="code-tab-links" onclick="selectLanguage(event, '9', 'c')">C</button>
  <button id="button_9_cpp" class="code-tab-links" onclick="selectLanguage(event, '9', 'cpp')">C++</button>
</div>
<div id="div_9_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Create a physical endpoint numbered 2</span></div>
<div class="line"><a class="code" href="struct_rdmnet_physical_endpoint_config.html">RdmnetPhysicalEndpointConfig</a> endpoint_config = <a class="code" href="group__rdmnet__device.html#gae49152ddbe7def8c181623e8a41590bb">RDMNET_PHYSICAL_ENDPOINT_INIT</a>(2);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// UIDs for a group of responders that have already been discovered on this endpoint are contained</span></div>
<div class="line"><span class="comment">// in the responders array below.</span></div>
<div class="line"><a class="code" href="struct_rdmnet_physical_endpoint_responder.html">RdmnetPhysicalEndpointResponder</a> responders[3];</div>
<div class="line"><span class="comment">// Assume the above array is filled in with the correct responder information...</span></div>
<div class="line"> </div>
<div class="line">endpoint_config.<a class="code" href="struct_rdmnet_physical_endpoint_config.html#affdd1b20ea4fe23f6c7ecca7dcf85960">responders</a> = responders;</div>
<div class="line">endpoint_config.<a class="code" href="struct_rdmnet_physical_endpoint_config.html#ae03e7714ab2513f42f6576df7da65738">num_responders</a> = 3;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Add the endpoint</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__device.html#ga669ad8832cd619410d3baa0b7cdcdee5">rdmnet_device_add_physical_endpoint</a>(my_device_handle, &amp;endpoint_config);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// The endpoint has been added. If currently connected, the library will send the proper</span></div>
<div class="line">  <span class="comment">// notification which indicates to connected controllers that there is a new endpoint and new</span></div>
<div class="line">  <span class="comment">// responders present.</span></div>
<div class="line">}</div>
<div class="ttc" id="astruct_rdmnet_physical_endpoint_config_html_ae03e7714ab2513f42f6576df7da65738"><div class="ttname"><a href="struct_rdmnet_physical_endpoint_config.html#ae03e7714ab2513f42f6576df7da65738">RdmnetPhysicalEndpointConfig::num_responders</a></div><div class="ttdeci">size_t num_responders</div><div class="ttdoc">Size of the responders array.</div><div class="ttdef"><b>Definition:</b> device.h:204</div></div>
<div class="ttc" id="astruct_rdmnet_physical_endpoint_config_html_affdd1b20ea4fe23f6c7ecca7dcf85960"><div class="ttname"><a href="struct_rdmnet_physical_endpoint_config.html#affdd1b20ea4fe23f6c7ecca7dcf85960">RdmnetPhysicalEndpointConfig::responders</a></div><div class="ttdeci">const RdmnetPhysicalEndpointResponder * responders</div><div class="ttdoc">An array of initial physical RDM responders on this endpoint, identified by static UID.</div><div class="ttdef"><b>Definition:</b> device.h:202</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_9_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Create a physical endpoint numbered 2 with the UIDs and control fields of 3</span></div>
<div class="line"><span class="comment">// previously-discovered physical responders.</span></div>
<div class="line">std::vector&lt;rdmnet::PhysicalEndpointResponder&gt; responders = {</div>
<div class="line">  <a class="code" href="classrdmnet_1_1_physical_endpoint_responder.html">rdmnet::PhysicalEndpointResponder</a>({0x6574, 0x00000001}, 0),</div>
<div class="line">  <a class="code" href="classrdmnet_1_1_physical_endpoint_responder.html">rdmnet::PhysicalEndpointResponder</a>({0x6574, 0x00000002}, 0),</div>
<div class="line">  <a class="code" href="classrdmnet_1_1_physical_endpoint_responder.html">rdmnet::PhysicalEndpointResponder</a>({0x6574, 0x00000003}, 0),</div>
<div class="line">};</div>
<div class="line"><a class="code" href="classrdmnet_1_1_physical_endpoint_config.html">rdmnet::PhysicalEndpointConfig</a> endpoint_config(2, responders);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Add the endpoint</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#a875fae87db81a2fe2236566e45892f1b">AddPhysicalEndpoint</a>(endpoint_config);</div>
<div class="line"><span class="keywordflow">if</span> (result)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// The endpoint has been added. If currently connected, the library will send the proper</span></div>
<div class="line">  <span class="comment">// notification which indicates to connected controllers that there is a new endpoint and new</span></div>
<div class="line">  <span class="comment">// responders present.</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_physical_endpoint_config_html"><div class="ttname"><a href="classrdmnet_1_1_physical_endpoint_config.html">rdmnet::PhysicalEndpointConfig</a></div><div class="ttdoc">Configuration information for a physical endpoint on a device.</div><div class="ttdef"><b>Definition:</b> device.h:251</div></div>
<div class="ttc" id="aclassrdmnet_1_1_physical_endpoint_responder_html"><div class="ttname"><a href="classrdmnet_1_1_physical_endpoint_responder.html">rdmnet::PhysicalEndpointResponder</a></div><div class="ttdoc">Identifying information for a physical RDM responder connected to an RDMnet gateway.</div><div class="ttdef"><b>Definition:</b> device.h:203</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<h2>Adding Virtual Endpoints and Responders</h2>
<p>The process for adding virtual endpoints is similar to that for physical endpoints, except that virtual responders can have Dynamic UIDs (see <a class="el" href="roles_and_addressing.html">Roles and Addressing</a> for more information about this).</p>
<p> 
<div class="code-tab-selector">
  <button id="button_10_c" class="code-tab-links" onclick="selectLanguage(event, '10', 'c')">C</button>
  <button id="button_10_cpp" class="code-tab-links" onclick="selectLanguage(event, '10', 'cpp')">C++</button>
</div>
<div id="div_10_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Create a virtual endpoint numbered 3</span></div>
<div class="line"><a class="code" href="struct_rdmnet_virtual_endpoint_config.html">RdmnetVirtualEndpointConfig</a> endpoint_config = <a class="code" href="group__rdmnet__device.html#ga95829f618daae7db1a9ba04049fc46c6">RDMNET_VIRTUAL_ENDPOINT_INIT</a>(3);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The virtual endpoint has a single responder that needs a dynamic UID. The responder needs a</span></div>
<div class="line"><span class="comment">// permanent Responder ID (RID), which is a UUID that should not change over the lifetime of the</span></div>
<div class="line"><span class="comment">// responder.</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/struct_etc_pal_uuid.html">EtcPalUuid</a> rid;</div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#ga8da6cbed139b61853a98f41120e73b29">etcpal_string_to_uuid</a>(<span class="stringliteral">&quot;f7c58fe2-d380-4367-91d1-b148eade448d&quot;</span>, &amp;rid);</div>
<div class="line">endpoint_config.<a class="code" href="struct_rdmnet_virtual_endpoint_config.html#a1ffc5cad463b0ecb1cbfcf73b7b939ca">dynamic_responders</a> = &amp;rid;</div>
<div class="line">endpoint_config.<a class="code" href="struct_rdmnet_virtual_endpoint_config.html#a4fd8e58c72865cbad3db8627aadb3f6f">num_dynamic_responders</a> = 1;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Add the endpoint</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__rdmnet__device.html#gaa4712d4dc1131e6d6390ce157c0aeb11">rdmnet_device_add_virtual_endpoint</a>(my_device_handle, &amp;endpoint_config);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// The endpoint has been added. If currently connected, the library will send the proper</span></div>
<div class="line">  <span class="comment">// notification which indicates to connected controllers that there is a new endpoint present,</span></div>
<div class="line">  <span class="comment">// and request a dynamic UID for the responder which will be delivered to the</span></div>
<div class="line">  <span class="comment">// RdmnetDeviceDynamicUidStatusCallback.</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__etcpal__uuid_html_ga8da6cbed139b61853a98f41120e73b29"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#ga8da6cbed139b61853a98f41120e73b29">etcpal_string_to_uuid</a></div><div class="ttdeci">bool etcpal_string_to_uuid(const char *str, EtcPalUuid *uuid)</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_ga95829f618daae7db1a9ba04049fc46c6"><div class="ttname"><a href="group__rdmnet__device.html#ga95829f618daae7db1a9ba04049fc46c6">RDMNET_VIRTUAL_ENDPOINT_INIT</a></div><div class="ttdeci">#define RDMNET_VIRTUAL_ENDPOINT_INIT(endpoint_num)</div><div class="ttdoc">An initializer for an RdmnetVirtualEndpointConfig instance.</div><div class="ttdef"><b>Definition:</b> device.h:174</div></div>
<div class="ttc" id="agroup__rdmnet__device_html_gaa4712d4dc1131e6d6390ce157c0aeb11"><div class="ttname"><a href="group__rdmnet__device.html#gaa4712d4dc1131e6d6390ce157c0aeb11">rdmnet_device_add_virtual_endpoint</a></div><div class="ttdeci">etcpal_error_t rdmnet_device_add_virtual_endpoint(rdmnet_device_t handle, const RdmnetVirtualEndpointConfig *endpoint_config)</div><div class="ttdoc">Add a virtual endpoint to a device.</div><div class="ttdef"><b>Definition:</b> device.c:584</div></div>
<div class="ttc" id="astruct_etc_pal_uuid_html"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/struct_etc_pal_uuid.html">EtcPalUuid</a></div></div>
<div class="ttc" id="astruct_rdmnet_virtual_endpoint_config_html"><div class="ttname"><a href="struct_rdmnet_virtual_endpoint_config.html">RdmnetVirtualEndpointConfig</a></div><div class="ttdoc">Configuration information for a virtual endpoint on a device.</div><div class="ttdef"><b>Definition:</b> device.h:145</div></div>
<div class="ttc" id="astruct_rdmnet_virtual_endpoint_config_html_a1ffc5cad463b0ecb1cbfcf73b7b939ca"><div class="ttname"><a href="struct_rdmnet_virtual_endpoint_config.html#a1ffc5cad463b0ecb1cbfcf73b7b939ca">RdmnetVirtualEndpointConfig::dynamic_responders</a></div><div class="ttdeci">const EtcPalUuid * dynamic_responders</div><div class="ttdoc">An array of initial virtual RDM responders on this endpoint, identified by RID.</div><div class="ttdef"><b>Definition:</b> device.h:152</div></div>
<div class="ttc" id="astruct_rdmnet_virtual_endpoint_config_html_a4fd8e58c72865cbad3db8627aadb3f6f"><div class="ttname"><a href="struct_rdmnet_virtual_endpoint_config.html#a4fd8e58c72865cbad3db8627aadb3f6f">RdmnetVirtualEndpointConfig::num_dynamic_responders</a></div><div class="ttdeci">size_t num_dynamic_responders</div><div class="ttdoc">Size of the dynamic_responders array.</div><div class="ttdef"><b>Definition:</b> device.h:154</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_10_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="comment">// Create a virtual endpoint numbered 3, which has a single responder that needs a dynamic UID. The</span></div>
<div class="line"><span class="comment">// responder needs a permanent Responder ID (RID), which is a UUID that should not change over the</span></div>
<div class="line"><span class="comment">// lifetime of the responder.</span></div>
<div class="line">std::vector&lt;etcpal::Uuid&gt; responders = { <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_uuid.html#ab017791f5f66829527591d8bd6bd840f">etcpal::Uuid::FromString</a>(<span class="stringliteral">&quot;f7c58fe2-d380-4367-91d1-b148eade448d&quot;</span>) };</div>
<div class="line"><a class="code" href="classrdmnet_1_1_virtual_endpoint_config.html">rdmnet::VirtualEndpointConfig</a> endpoint_config(3, responders);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Add the endpoint</span></div>
<div class="line"><a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = device.<a class="code" href="classrdmnet_1_1_device.html#a99f7314c8662242597afe5c54b4800d7">AddVirtualEndpoint</a>(endpoint_config);</div>
<div class="line"><span class="keywordflow">if</span> (result)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// The endpoint has been added. If currently connected, the library will send the proper</span></div>
<div class="line">  <span class="comment">// notification which indicates to connected controllers that there is a new endpoint present,</span></div>
<div class="line">  <span class="comment">// and request a dynamic UID for the responder which will be delivered to the</span></div>
<div class="line">  <span class="comment">// MyDeviceNotifyHandler::HandleDynamicUidStatus() callback.</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassetcpal_1_1_uuid_html_ab017791f5f66829527591d8bd6bd840f"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_uuid.html#ab017791f5f66829527591d8bd6bd840f">etcpal::Uuid::FromString</a></div><div class="ttdeci">static Uuid FromString(const char *uuid_str) noexcept</div></div>
<div class="ttc" id="aclassrdmnet_1_1_device_html_a99f7314c8662242597afe5c54b4800d7"><div class="ttname"><a href="classrdmnet_1_1_device.html#a99f7314c8662242597afe5c54b4800d7">rdmnet::Device::AddVirtualEndpoint</a></div><div class="ttdeci">etcpal::Error AddVirtualEndpoint(const VirtualEndpointConfig &amp;endpoint_config)</div><div class="ttdoc">Add a virtual endpoint to a device.</div><div class="ttdef"><b>Definition:</b> device.h:875</div></div>
<div class="ttc" id="aclassrdmnet_1_1_virtual_endpoint_config_html"><div class="ttname"><a href="classrdmnet_1_1_virtual_endpoint_config.html">rdmnet::VirtualEndpointConfig</a></div><div class="ttdoc">Configuration information for a virtual endpoint on a device.</div><div class="ttdef"><b>Definition:</b> device.h:71</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>Before dynamic virtual responders can be used, they must be assigned a dynamic UID. The status of dynamic UID assignment is communicated through the dynamic UID status callback.</p>
<p> 
<div class="code-tab-selector">
  <button id="button_11_c" class="code-tab-links" onclick="selectLanguage(event, '11', 'c')">C</button>
  <button id="button_11_cpp" class="code-tab-links" onclick="selectLanguage(event, '11', 'cpp')">C++</button>
</div>
<div id="div_11_c" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> handle_dynamic_uid_status(<a class="code" href="group__rdmnet__device.html#gad17bb8836a86ad4c8a774cd94a01d63c">rdmnet_device_t</a> handle, <span class="keyword">const</span> <a class="code" href="struct_rdmnet_dynamic_uid_assignment_list.html">RdmnetDynamicUidAssignmentList</a>* list, <span class="keywordtype">void</span>* context)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles and/or context as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="struct_rdmnet_dynamic_uid_mapping.html">RdmnetDynamicUidMapping</a>* mapping = list-&gt;<a class="code" href="struct_rdmnet_dynamic_uid_assignment_list.html#af8d7a5c73e14c6d2f6aa2619619c6ddb">mappings</a>; mapping &lt; list-&gt;mappings + list-&gt;<a class="code" href="struct_rdmnet_dynamic_uid_assignment_list.html#a3725222dfe8114e80a413479ad6e8f1a">num_mappings</a>;</div>
<div class="line">       ++mapping)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (mapping-&gt;status_code == <a class="code" href="group__rdmnet__api__common.html#ggafc5c9ee7dffbca259051716bacea9620a1b3e6c28f0859c283862abf73923b388">kRdmnetDynamicUidStatusOk</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// This function is assumed to add the dynamic UID to the virtual responder&#39;s runtime data.</span></div>
<div class="line">      <span class="comment">// This UID should be used to determine whether an RDM command received later is addressed to</span></div>
<div class="line">      <span class="comment">// the virtual responder.</span></div>
<div class="line">      set_responder_dynamic_uid(&amp;mapping-&gt;rid, &amp;mapping-&gt;uid);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">char</span> rid_str[<a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#gabab14207e273082491f7be2a21275092">ETCPAL_UUID_STRING_BYTES</a>];</div>
<div class="line">      <a class="codeRef" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#ga479b00b02ab33cf757e9476ad3286336">etcpal_uuid_to_string</a>(&amp;mapping-&gt;rid, rid_str);</div>
<div class="line">      printf(<span class="stringliteral">&quot;Error obtaining dynamic UID for responder %s: &#39;%s&#39;\n&quot;</span>, rid_str,</div>
<div class="line">             <a class="code" href="group__rdmnet__api__common.html#ga362e057a96421081d8551d65bf403b6a">rdmnet_dynamic_uid_status_to_string</a>(mapping-&gt;status_code));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__etcpal__uuid_html_ga479b00b02ab33cf757e9476ad3286336"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#ga479b00b02ab33cf757e9476ad3286336">etcpal_uuid_to_string</a></div><div class="ttdeci">bool etcpal_uuid_to_string(const EtcPalUuid *uuid, char *buf)</div></div>
<div class="ttc" id="agroup__etcpal__uuid_html_gabab14207e273082491f7be2a21275092"><div class="ttname"><a href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#gabab14207e273082491f7be2a21275092">ETCPAL_UUID_STRING_BYTES</a></div><div class="ttdeci">#define ETCPAL_UUID_STRING_BYTES</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ga362e057a96421081d8551d65bf403b6a"><div class="ttname"><a href="group__rdmnet__api__common.html#ga362e057a96421081d8551d65bf403b6a">rdmnet_dynamic_uid_status_to_string</a></div><div class="ttdeci">const char * rdmnet_dynamic_uid_status_to_string(rdmnet_dynamic_uid_status_t code)</div><div class="ttdoc">Get a string description of an RDMnet Dynamic UID status code.</div><div class="ttdef"><b>Definition:</b> common.c:392</div></div>
<div class="ttc" id="agroup__rdmnet__api__common_html_ggafc5c9ee7dffbca259051716bacea9620a1b3e6c28f0859c283862abf73923b388"><div class="ttname"><a href="group__rdmnet__api__common.html#ggafc5c9ee7dffbca259051716bacea9620a1b3e6c28f0859c283862abf73923b388">kRdmnetDynamicUidStatusOk</a></div><div class="ttdeci">@ kRdmnetDynamicUidStatusOk</div><div class="ttdoc">The Dynamic UID Mapping was fetched or assigned successfully.</div><div class="ttdef"><b>Definition:</b> common.h:136</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_assignment_list_html"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_assignment_list.html">RdmnetDynamicUidAssignmentList</a></div><div class="ttdoc">A list of mappings from dynamic UIDs to responder IDs received from an RDMnet broker.</div><div class="ttdef"><b>Definition:</b> message.h:245</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_assignment_list_html_a3725222dfe8114e80a413479ad6e8f1a"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_assignment_list.html#a3725222dfe8114e80a413479ad6e8f1a">RdmnetDynamicUidAssignmentList::num_mappings</a></div><div class="ttdeci">size_t num_mappings</div><div class="ttdoc">The size of the mappings array.</div><div class="ttdef"><b>Definition:</b> message.h:249</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_assignment_list_html_af8d7a5c73e14c6d2f6aa2619619c6ddb"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_assignment_list.html#af8d7a5c73e14c6d2f6aa2619619c6ddb">RdmnetDynamicUidAssignmentList::mappings</a></div><div class="ttdeci">RdmnetDynamicUidMapping * mappings</div><div class="ttdoc">An array of dynamic UID mappings.</div><div class="ttdef"><b>Definition:</b> message.h:247</div></div>
<div class="ttc" id="astruct_rdmnet_dynamic_uid_mapping_html"><div class="ttname"><a href="struct_rdmnet_dynamic_uid_mapping.html">RdmnetDynamicUidMapping</a></div><div class="ttdoc">A mapping from a dynamic UID to a responder ID (RID).</div><div class="ttdef"><b>Definition:</b> message.h:234</div></div>
</div><!-- fragment --><p> 
</div>
<div id="div_11_cpp" class="code-tab-content">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyDeviceNotifyHandler::HandleDynamicUidStatus(<a class="code" href="classrdmnet_1_1_device.html#a7e0d6654da08564c996e6518ebe5def9">rdmnet::Device::Handle</a> handle,</div>
<div class="line">                                                   <span class="keyword">const</span> <a class="code" href="classrdmnet_1_1_dynamic_uid_assignment_list.html">rdmnet::DynamicUidAssignmentList</a>&amp; list)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Check handles as necessary...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="structrdmnet_1_1_dynamic_uid_mapping.html">rdmnet::DynamicUidMapping</a>&amp; mapping : list.<a class="code" href="classrdmnet_1_1_dynamic_uid_assignment_list.html#adcbcc8c9912e129b23d55e15565433d6">GetMappings</a>())</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (mapping.IsOk())</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// This function is assumed to add the dynamic UID to the virtual responder&#39;s runtime data.</span></div>
<div class="line">      <span class="comment">// This UID should be used to determine whether an RDM command received later is addressed to</span></div>
<div class="line">      <span class="comment">// the virtual responder.</span></div>
<div class="line">      SetResponderDynamicUid(mapping.rid, mapping.uid);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Error obtaining dynamic UID for responder &quot;</span> &lt;&lt; mapping.rid.ToString() &lt;&lt; <span class="stringliteral">&quot;: &#39;&quot;</span></div>
<div class="line">                &lt;&lt; mapping.CodeToString() &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassrdmnet_1_1_dynamic_uid_assignment_list_html"><div class="ttname"><a href="classrdmnet_1_1_dynamic_uid_assignment_list.html">rdmnet::DynamicUidAssignmentList</a></div><div class="ttdoc">A list of mappings from dynamic UIDs to responder IDs received from an RDMnet broker.</div><div class="ttdef"><b>Definition:</b> dynamic_uid.h:98</div></div>
<div class="ttc" id="aclassrdmnet_1_1_dynamic_uid_assignment_list_html_adcbcc8c9912e129b23d55e15565433d6"><div class="ttname"><a href="classrdmnet_1_1_dynamic_uid_assignment_list.html#adcbcc8c9912e129b23d55e15565433d6">rdmnet::DynamicUidAssignmentList::GetMappings</a></div><div class="ttdeci">std::vector&lt; DynamicUidMapping &gt; GetMappings() const</div><div class="ttdoc">Copy out the list of dynamic UID mappings.</div><div class="ttdef"><b>Definition:</b> dynamic_uid.h:129</div></div>
<div class="ttc" id="astructrdmnet_1_1_dynamic_uid_mapping_html"><div class="ttname"><a href="structrdmnet_1_1_dynamic_uid_mapping.html">rdmnet::DynamicUidMapping</a></div><div class="ttdoc">A mapping from a dynamic UID to a responder ID (RID).</div><div class="ttdef"><b>Definition:</b> dynamic_uid.h:41</div></div>
</div><!-- fragment --><p> 
</div>
</p>
<p>One last thing about endpoints: if the set of physical and virtual endpoints that a device has is known at initialization time, they can be added to the initial configuration structures for a device instance, so that they don't need to be added later.</p>
<h1>Handling RDM Commands</h1>
<p>Handling RDM commands is the main functionality of RDMnet devices. See <a class="el" href="handling_rdm_commands.html">Handling RDM Commands</a> for information on how to do this. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="getting_started.html">Getting Started</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
